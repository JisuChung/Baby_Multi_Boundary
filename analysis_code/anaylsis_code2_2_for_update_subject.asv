
% if you want to load data
load('250205_workplace.mat')

%%

% group selection 

age_range = [6,8];
% MB_reject.sub_reject = ismember(participant_info.ID, [240706504]);
MB_reject.sub_reject = ismember(participant_info.ID, [240203203, 240217101, 240706504, 270706505]);



www_reject.sub_reject = ismember(www_participant_info.ID, []);
ctrl_reject.sub_reject = ismember(ctrl_participant_info.ID, [240803403]);

age_group = participant_info.age_yr>=age_range(1) &  participant_info.age_yr<= age_range(2);
www_age_group = www_participant_info.age_yr>=(age_range(1)) &  www_participant_info.age_yr<=(age_range(2)) ;
ctrl_age_group = ctrl_participant_info.age_yr>=age_range(1) &  ctrl_participant_info.age_yr<= age_range(2);

% ctrl_age_group = ismember(ctrl_participant_info.ID, [240803403])
% age_group = ismember(participant_info.ID, [240709504])
% www_age_group = ismember(www_participant_info.ID, [230709301])
% age_group = participant_info.age_yr<=8 & participant_info.age_yr>=6;
% www_age_group = www_participant_info.age_yr<=8 & www_participant_info.age_yr>=6;



WWW_group_select = www_age_group & ~www_reject.sub_reject;
MB_group_select = age_group & ~MB_reject.sub_reject;
ctrl_group_select = ctrl_age_group & ~ctrl_reject.sub_reject;



em_color = [0.988235294117647	0.623529411764706	0.356862745098039;
0.988235294117647	0.623529411764706	0.356862745098039;
0.356862745098039	0.556862745098039	0.490196078431373;
0.356862745098039	0.556862745098039	0.490196078431373;
0.368627450980392	0.345098039215686	0.372549019607843;
0.282352941176471	0.262745098039216	0.286274509803922];



Inter_Color = [.3 .7 .3; .6 .6 .6; .6 .6 .6; .6 .8 .6];

Inter_Color_cat12 = [.6 .6 .6; .6 .8 .6];
Inter_Color_cat12_g =  [.4 .4 .4; .4 .7 .4];
% 
% em_mb_color = [.5 .5 .5; .9 .5 .5];
% 
% mb_sb_mb_color = [.6 .7 .9; .7 .5 .9];


em_mb_color = [.5 .5 .5; .7 .5 .85];

em_mb_rt_color = [.6 .6 .6; .8 .6 .9];


mb_color = [.6 .7 .9; .9 .5 .55];


em_vb_mb_color = [.5 .5 .5; .6 .7 .9; .9 .5 .5];

task_Color.default = [0.9 0.6 1];


%% age curve



for agei = 4:9
    age_curve.www_inter_acc(agei) = nanmean(WWW_Behavior_table.inter_acc(WWW_Behavior_table.age==agei & WWW_group_select == 1));
    age_curve.www_inter_acc_cat1(agei) = nanmean(WWW_Behavior_table.inter_acc_cat1(WWW_Behavior_table.age==agei & WWW_group_select == 1));
    age_curve.www_inter_acc_cat2(agei) = nanmean(WWW_Behavior_table.inter_acc_cat2(WWW_Behavior_table.age==agei & WWW_group_select == 1));

    age_curve.multi_inter_acc(agei) = nanmean(Behavior_table.inter_acc(Behavior_table.age==agei & MB_group_select == 1));
    age_curve.multi_inter_acc_cat1(agei) = nanmean(Behavior_table.inter_acc_cat1(Behavior_table.age==agei & MB_group_select == 1));
    age_curve.multi_inter_acc_cat2(agei) = nanmean(Behavior_table.inter_acc_cat2(Behavior_table.age==agei & MB_group_select == 1));


    age_curve.ctrl__inter_acc(agei) = nanmean(ctrl_Behavior_table.inter_acc(ctrl_Behavior_table.age==agei  & ctrl_group_select == 1));
    age_curve.ctrl__inter_acc_cat1(agei) = nanmean(ctrl_Behavior_table.inter_acc_cat1(ctrl_Behavior_table.age==agei  & ctrl_group_select == 1));
    age_curve.ctrl__inter_acc_cat2(agei) = nanmean(ctrl_Behavior_table.inter_acc_cat2(ctrl_Behavior_table.age==agei  & ctrl_group_select == 1));


    age_curve.www_multi_inter_acc(agei) = nanmean([Behavior_table.inter_acc(Behavior_table.age==agei & MB_group_select == 1); WWW_Behavior_table.inter_acc(WWW_Behavior_table.age==agei & WWW_group_select == 1)]);
    age_curve.www_multi_inter_acc_cat1(agei) = nanmean([Behavior_table.inter_acc_cat1(Behavior_table.age==agei & MB_group_select == 1);WWW_Behavior_table.inter_acc_cat1(WWW_Behavior_table.age==agei & WWW_group_select == 1)]);
    age_curve.www_multi_inter_acc_cat2(agei) = nanmean([Behavior_table.inter_acc_cat2(Behavior_table.age==agei & MB_group_select == 1); WWW_Behavior_table.inter_acc_cat2(WWW_Behavior_table.age==agei & WWW_group_select == 1)]);


    age_curve.all_inter_acc(agei) = nanmean([Behavior_table.inter_acc(Behavior_table.age==agei & MB_group_select == 1); WWW_Behavior_table.inter_acc(WWW_Behavior_table.age==agei & WWW_group_select == 1); ctrl_Behavior_table.inter_acc(ctrl_Behavior_table.age==agei & ctrl_group_select == 1)]);
    age_curve.all_inter_acc_cat1(agei) = nanmean([Behavior_table.inter_acc_cat1(Behavior_table.age==agei & MB_group_select == 1);WWW_Behavior_table.inter_acc_cat1(WWW_Behavior_table.age==agei & WWW_group_select == 1); ctrl_Behavior_table.inter_acc(ctrl_Behavior_table.age==agei & ctrl_group_select == 1)]);
    age_curve.all_inter_acc_cat2(agei) = nanmean([Behavior_table.inter_acc_cat2(Behavior_table.age==agei & MB_group_select == 1); WWW_Behavior_table.inter_acc_cat2(WWW_Behavior_table.age==agei & WWW_group_select == 1); ctrl_Behavior_table.inter_acc(ctrl_Behavior_table.age==agei & ctrl_group_select == 1)]);

    age_curve.www_what(agei) = nanmean(WWW_Behavior_table.acc_what(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.www_whatwhen(agei) = nanmean(WWW_Behavior_table.acc_whatwhen(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.www_where(agei) = nanmean(WWW_Behavior_table.acc_where(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.www_wherewhen(agei) = nanmean(WWW_Behavior_table.acc_wherewhen(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.www_whatwhere(agei) = nanmean(WWW_Behavior_table.acc_whatwhere(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.www_fullem(agei) = nanmean(WWW_Behavior_table.acc_fullem(WWW_Behavior_table.age==agei & WWW_group_select ==1));


    age_curve.cross1_www_what(agei) = nanmean(WWW_Behavior_table.cross1_acc_what(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.cross1_www_whatwhen(agei) = nanmean(WWW_Behavior_table.cross1_acc_whatwhen(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.cross1_www_where(agei) = nanmean(WWW_Behavior_table.cross1_acc_where(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.cross1_www_wherewhen(agei) = nanmean(WWW_Behavior_table.cross1_acc_wherewhen(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.cross1_www_whatwhere(agei) = nanmean(WWW_Behavior_table.cross1_acc_whatwhere(WWW_Behavior_table.age==agei & WWW_group_select ==1));
    age_curve.cross1_www_fullem(agei) = nanmean(WWW_Behavior_table.cross1_acc_fullem(WWW_Behavior_table.age==agei & WWW_group_select ==1));


    age_curve.boundary_what(agei) = nanmean(Behavior_table.acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_whatwhen(agei) = nanmean(Behavior_table.acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_where(agei) = nanmean(Behavior_table.acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_wherewhen(agei) = nanmean(Behavior_table.acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_whatwhere(agei) = nanmean(Behavior_table.acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_fullem(agei) = nanmean(Behavior_table.acc_fullem(Behavior_table.age==agei & MB_group_select ==1));

    age_curve.boundary_ABD_what(agei) = nanmean(Behavior_table.all_ABD_acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_ABD_whatwhen(agei) = nanmean(Behavior_table.all_ABD_acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_ABD_where(agei) = nanmean(Behavior_table.all_ABD_acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_ABD_wherewhen(agei) = nanmean(Behavior_table.all_ABD_acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_ABD_whatwhere(agei) = nanmean(Behavior_table.all_ABD_acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_ABD_fullem(agei) = nanmean(Behavior_table.all_ABD_acc_fullem(Behavior_table.age==agei & MB_group_select ==1));


    age_curve.boundary_MBD_what(agei) = nanmean(Behavior_table.all_MBD_acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_MBD_whatwhen(agei) = nanmean(Behavior_table.all_MBD_acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_MBD_where(agei) = nanmean(Behavior_table.all_MBD_acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_MBD_wherewhen(agei) = nanmean(Behavior_table.all_MBD_acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_MBD_whatwhere(agei) = nanmean(Behavior_table.all_MBD_acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.boundary_MBD_fullem(agei) = nanmean(Behavior_table.all_MBD_acc_fullem(Behavior_table.age==agei & MB_group_select ==1));



    age_curve.cross1_boundary_what(agei) = nanmean(Behavior_table.select_acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_whatwhen(agei) = nanmean(Behavior_table.select_acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_where(agei) = nanmean(Behavior_table.select_acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_wherewhen(agei) = nanmean(Behavior_table.select_acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_whatwhere(agei) = nanmean(Behavior_table.select_acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_fullem(agei) = nanmean(Behavior_table.select_acc_fullem(Behavior_table.age==agei & MB_group_select ==1));


    age_curve.cross1_boundary_ABD_what(agei) = nanmean(Behavior_table.select_ABD_acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_ABD_whatwhen(agei) = nanmean(Behavior_table.select_ABD_acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_ABD_where(agei) = nanmean(Behavior_table.select_ABD_acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_ABD_wherewhen(agei) = nanmean(Behavior_table.select_ABD_acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_ABD_whatwhere(agei) = nanmean(Behavior_table.select_ABD_acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_ABD_fullem(agei) = nanmean(Behavior_table.select_ABD_acc_fullem(Behavior_table.age==agei & MB_group_select ==1));


    age_curve.cross1_boundary_MBD_what(agei) = nanmean(Behavior_table.select_MBD_acc_what(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_MBD_whatwhen(agei) = nanmean(Behavior_table.select_MBD_acc_whatwhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_MBD_where(agei) = nanmean(Behavior_table.select_MBD_acc_where(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_MBD_wherewhen(agei) = nanmean(Behavior_table.select_MBD_acc_wherewhen(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_MBD_whatwhere(agei) = nanmean(Behavior_table.select_MBD_acc_whatwhere(Behavior_table.age==agei & MB_group_select ==1));
    age_curve.cross1_boundary_MBD_fullem(agei) = nanmean(Behavior_table.select_MBD_acc_fullem(Behavior_table.age==agei & MB_group_select ==1));



end


%% Interference Age Curve (www)



plot_age_range = 5:9;
selected_data1 = age_curve.www_inter_acc_cat1(plot_age_range)
selected_data2 = age_curve.www_inter_acc_cat2(plot_age_range)
selected_data3 = age_curve.www_inter_acc(plot_age_range)

a = figure();

line1 = plot(plot_age_range, selected_data1, '-o', 'LineWidth', 2, 'Color', Inter_Color(2, :));
hold on
line2 = plot(plot_age_range, selected_data2, '-o', 'LineWidth', 2, 'Color', Inter_Color(1, :));


xlim([4.7 9.3])
ylim([.6 1])



legend_h = legend({' Category 1', ' Category 2'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_age_range)
yticks([.5 .6 .7 .8 .9 1])

set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off


title(['Interference AGE TREND ' num2str(plot_age_range(1)) '-' num2str(plot_age_range(end)) ],'FontWeight','bold')


%% www age curve 
a = figure();

% age_range = 5:16;
plot_age_range = 5:9;
% em_trend(7, :) = em_trend(8, :)
% em_trend(8, :) = nan(1, 6);
clf
plot(plot_age_range, age_curve.cross1_www_what(plot_age_range), '-o', 'LineWidth', 2, 'Color', em_color(1, :))
hold on
plot(plot_age_range, age_curve.cross1_www_whatwhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(2, :))
hold on
plot(plot_age_range, age_curve.cross1_www_where(plot_age_range), '-o', 'LineWidth', 2 , 'Color', em_color(3, :))
hold on
plot(plot_age_range, age_curve.cross1_www_wherewhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(4, :))
hold on 
plot(plot_age_range, age_curve.cross1_www_whatwhere(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(5, :))
hold on
plot(plot_age_range, age_curve.cross1_www_fullem(plot_age_range), ':o', 'LineWidth', 2, 'Color', em_color(6, :))

legend_h = legend({'what', '+when', 'where', '+when', 'what-where', 'full EM'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_age_range)
xlim([4.7 9.2])
ylim([0 1])
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

set(gca,'color','none')

title(['WCDI AGE TREND ' num2str(plot_age_range(1)) '-' num2str(plot_age_range(2)) ],'FontWeight','bold')

%% boundary age curve 
a = figure();

% plot_age_range = 5:16;
plot_age_range = 5:9;
% em_trend(7, :) = em_trend(8, :)
% em_trend(8, :) = nan(1, 6);
clf
plot(plot_age_range, age_curve.cross1_boundary_what(plot_age_range), '-o', 'LineWidth', 2, 'Color', em_color(1, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_whatwhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(2, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_where(plot_age_range), '-o', 'LineWidth', 2 , 'Color', em_color(3, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_wherewhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(4, :))
hold on 
plot(plot_age_range, age_curve.cross1_boundary_whatwhere(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(5, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_fullem(plot_age_range), ':o', 'LineWidth', 2, 'Color', em_color(6, :))

legend_h = legend({'what', '+when', 'where', '+when', 'what-where', 'full EM'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_age_range)
xlim([4.7 9.2])
ylim([0 1])
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off


title(['Boundary all condition-  AGE TREND ' num2str(plot_age_range(1)) '-' num2str(plot_age_range(end)) ],'FontWeight','bold')


%% boundary age curve 
a = figure();
subplot(1,2,1)

% plot_age_range = 5:16;
% plot_age_range = 5:9;
% em_trend(7, :) = em_trend(8, :)
% em_trend(8, :) = nan(1, 6);
% clf
plot(plot_age_range, age_curve.cross1_boundary_ABD_what(plot_age_range), '-o', 'LineWidth', 2, 'Color', em_color(1, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_ABD_whatwhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(2, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_ABD_where(plot_age_range), '-o', 'LineWidth', 2 , 'Color', em_color(3, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_ABD_wherewhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(4, :))
hold on 
plot(plot_age_range, age_curve.cross1_boundary_ABD_whatwhere(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(5, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_ABD_fullem(plot_age_range), ':o', 'LineWidth', 2, 'Color', em_color(6, :))

legend_h = legend({'what', '+when', 'where', '+when', 'what-where', 'full EM'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_age_range)
xlim([4.7 9.2])
ylim([0 1])
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off
title(['Visual Boundary AGE TREND ' num2str(plot_age_range(1)) '-' num2str(plot_age_range(end)) ],'FontWeight','bold')

subplot(1,2,2)

% plot_age_range = 5:16;
% plot_age_range = 5:9;
% em_trend(7, :) = em_trend(8, :)
% em_trend(8, :) = nan(1, 6);
% clf
plot(plot_age_range, age_curve.cross1_boundary_MBD_what(plot_age_range), '-o', 'LineWidth', 2, 'Color', em_color(1, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_MBD_whatwhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(2, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_MBD_where(plot_age_range), '-o', 'LineWidth', 2 , 'Color', em_color(3, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_MBD_wherewhen(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(4, :))
hold on 
plot(plot_age_range, age_curve.cross1_boundary_MBD_whatwhere(plot_age_range), '--o', 'LineWidth', 2, 'Color', em_color(5, :))
hold on
plot(plot_age_range, age_curve.cross1_boundary_MBD_fullem(plot_age_range), ':o', 'LineWidth', 2, 'Color', em_color(6, :))

% legend_h = legend({'what', '+when', 'where', '+when', 'what-where', 'full EM'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_age_range)
xlim([4.7 9.2])
ylim([0 1])
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off
title(['Visual+audio Boundary all condition-  AGE TREND ' num2str(plot_age_range(1)) '-' num2str(plot_age_range(end)) ],'FontWeight','bold')





%% AGE GROUP (after reject)



for ai = 4:9
    www_age_array(ai-3,1) = sum(strcmp(www_participant_info.sex, '남') & (www_participant_info.age_yr == ai));
    www_age_array(ai-3,2) = sum(strcmp(www_participant_info.sex, '여') & (www_participant_info.age_yr == ai));
    www_age_array(ai-3,3) = sum((www_participant_info.age_yr == ai));
    age_array(ai-3,1) = sum(strcmp(participant_info.sex, '남') & (participant_info.age_yr == ai) & ~MB_reject.sub_reject);
    age_array(ai-3,2) = sum(strcmp(participant_info.sex, '여') & (participant_info.age_yr == ai) & ~MB_reject.sub_reject);
    age_array(ai-3,3) = sum((participant_info.age_yr == ai) & ~MB_reject.sub_reject);
    ctrl_age_array(ai-3,1) = sum(strcmp(ctrl_participant_info.sex, '남') & (ctrl_participant_info.age_yr == ai) & ~ctrl_reject.sub_reject);
    ctrl_age_array(ai-3,2) = sum(strcmp(ctrl_participant_info.sex, '여') & (ctrl_participant_info.age_yr == ai) & ~ctrl_reject.sub_reject);
    ctrl_age_array(ai-3,3) = sum((ctrl_participant_info.age_yr == ai) & ~ctrl_reject.sub_reject);

end
for fi = 1:3
    www_age_array(7, fi) = sum(www_age_array(1:6,fi));
    age_array(7, fi) = sum(age_array(1:6,fi));
    ctrl_age_array(7, fi) = sum(ctrl_age_array(1:6,fi));
end

www_age_array
age_array
ctrl_age_array 
% www_age_table 


%% AGE HISTOGRAM
histo_group = age_group;
www_histo_group = www_age_group;


a = figure();
a.Position = [1000 918 205 253];
% subplot(2,1,1);
histogram(participant_info.age_yr((strcmp(participant_info.sex, '남') & (histo_group == 1) & ~MB_reject.sub_reject) == 1,:));hold on;
histogram(participant_info.age_yr((strcmp(participant_info.sex, '여') & (histo_group == 1) & ~MB_reject.sub_reject) == 1,:)); 
histogram(participant_info.age_yr((histo_group == 1)& ~MB_reject.sub_reject) , 'FaceColor','none');
xlim([age_range(1)-0.75 age_range(2)+0.75]);
ylim([0 25]);
title(['Boundary' newline '(n = ' num2str(sum(histo_group == 1)) ')' ] , 'FontSize',13, 'FontWeight','bold');

a = figure();
a.Position = [1000 918 205 253];
% subplot(2,1,1);

histogram(www_participant_info.age_yr((strcmp(www_participant_info.sex, '남') & (www_histo_group == 1)) == 1,:));hold on;
histogram(www_participant_info.age_yr((strcmp(www_participant_info.sex, '여') & (www_histo_group == 1)) == 1,:)); 
histogram(www_participant_info.age_yr(www_histo_group == 1), 'FaceColor','none');
xlim([age_range(1)-0.75 age_range(2)+0.75]);
ylim([0 25]);
title(['Non Boundary' newline '(n = ' num2str(sum(www_histo_group == 1)) ')' ], 'FontSize',13, 'FontWeight','bold');


%% [WWW & MB] acc www (all trial)
a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group{1} = WWW_Behavior_table.acc_what(WWW_group_select ==1);
WWW_Group{2} = WWW_Behavior_table.acc_whatwhen(WWW_group_select ==1);
WWW_Group{3} = WWW_Behavior_table.acc_where(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.acc_wherewhen(WWW_group_select ==1);
WWW_Group{5} = WWW_Behavior_table.acc_whatwhere(WWW_group_select ==1);
WWW_Group{6} = WWW_Behavior_table.acc_fullem(WWW_group_select ==1);


MB_Group{1} = Behavior_table.acc_what(MB_group_select ==1);
MB_Group{2} = Behavior_table.acc_whatwhen(MB_group_select ==1);
MB_Group{3} = Behavior_table.acc_where(MB_group_select ==1);
MB_Group{4} = Behavior_table.acc_wherewhen(MB_group_select ==1);
MB_Group{5} = Behavior_table.acc_whatwhere(MB_group_select ==1);
MB_Group{6} = Behavior_table.acc_fullem(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), 1:6, 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), 1:6, 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})

    % ranksum
%     [p(ti), h(ti)] = ranksum(round(WWW_Group{ti},3), round(MB_Group{ti},3))

end

% =======================================================================

% draw bar
mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); %[.9 .5 .5]; % .2 .2. 2; .3 .4 .5 ];

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_color(1,:);  % [.5 .5 .5];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, MBavg(bi)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where'; 'FullEM'};
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'Boundary', '', 'Non boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['all trial age ' num2str(age_range(1)) '-' num2str(age_range(2)) ],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB] acc www (1 crossing trial)
a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select ==1);
WWW_Group{2} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==1);
WWW_Group{3} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==1);
WWW_Group{5} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==1);
WWW_Group{6} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_acc_what(MB_group_select ==1);
MB_Group{2} = Behavior_table.select_acc_whatwhen(MB_group_select ==1);
MB_Group{3} = Behavior_table.select_acc_where(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_acc_wherewhen(MB_group_select ==1);
MB_Group{5} = Behavior_table.select_acc_whatwhere(MB_group_select ==1);
MB_Group{6} = Behavior_table.select_acc_fullem(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), 1:6, 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), 1:6, 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})

    % ranksum
%     [p(ti), h(ti)] = ranksum(round(WWW_Group{ti},3), round(MB_Group{ti},3))

end

% =======================================================================

% draw bar
mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); %[.9 .5 .5]; % .2 .2. 2; .3 .4 .5 ];

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_color(1,:);  % [.5 .5 .5];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, MBavg(bi)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where'; 'FullEM'};
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'Boundary', '', 'Non boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['1 crossing trial age ' num2str(age_range(1)) '-' num2str(age_range(2)) ],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB] acc www (1 crossing trial) - association & www
a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

% WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select ==1);
WWW_Group{1} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==1);
% WWW_Group{3} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==1);
WWW_Group{3} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==1);
% WWW_Group{5} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==1);
WWW_Group{5} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==1);


% MB_Group{1} = Behavior_table.select_acc_what(MB_group_select ==1);
MB_Group{2} = Behavior_table.select_acc_whatwhen(MB_group_select ==1);
% MB_Group{3} = Behavior_table.select_acc_where(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_acc_wherewhen(MB_group_select ==1);
% MB_Group{5} = Behavior_table.select_acc_whatwhere(MB_group_select ==1);
MB_Group{6} = Behavior_table.select_acc_fullem(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
% WWW_Group_data = cell2mat(WWW_Group');
% www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), 1:6, 'uni', 0)');
% [~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
% www_group_compare = multcompare(www_stats,"Display","off")

% 
% MB_Group_data = cell2mat(MB_Group');
% mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), 1:6, 'uni', 0)');
% [~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
% mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:3
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group{(ti-1)*2+1}, MB_Group{ti*2})

    % ranksum
%     [p(ti), h(ti)] = ranksum(round(WWW_Group{ti},3), round(MB_Group{ti},3))

end

% =======================================================================

% draw bar
mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); %[.9 .5 .5]; % .2 .2. 2; .3 .4 .5 ];

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_color(1,:);  % [.5 .5 .5];

% significance ==========================================================
for bi = 1:3
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, MBavg(bi)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])

xline([2.5 4.5],'--', 'Color', [.6 .6 .6], 'LineWidth',2)

% labels
xticks([1.5 3.5 5.5])
acc_Labels = {' What+When '; ' Where+When '; ' FullEM '; };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'Boundary', '', 'Non boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['1 crossing trial age ' num2str(age_range(1)) '-' num2str(age_range(2)) ],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW & MB] acc www (1 crossing trial) - LOCATION CAT
a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select ==1);
WWW_Group{2} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==1);
WWW_Group{3} = WWW_Behavior_table.cross1_acc_loc_cat_where(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_loc_cat_wherewhen(WWW_group_select ==1);
WWW_Group{5} = WWW_Behavior_table.cross1_acc_loc_cat_whatwhere(WWW_group_select ==1);
WWW_Group{6} = WWW_Behavior_table.cross1_acc_loc_cat_fullem(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_acc_what(MB_group_select ==1);
MB_Group{2} = Behavior_table.select_acc_whatwhen(MB_group_select ==1);
MB_Group{3} = Behavior_table.select_acc_loc_cat_where(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_acc_loc_cat_wherewhen(MB_group_select ==1);
MB_Group{5} = Behavior_table.select_acc_loc_cat_whatwhere(MB_group_select ==1);
MB_Group{6} = Behavior_table.select_acc_loc_cat_fullem(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), 1:6, 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), 1:6, 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})

    % ranksum
%     [p(ti), h(ti)] = ranksum(round(WWW_Group{ti},3), round(MB_Group{ti},3))

end

% =======================================================================

% draw bar
mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); %[.9 .5 .5]; % .2 .2. 2; .3 .4 .5 ];

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_color(1,:);  % [.5 .5 .5];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, MBavg(bi)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where'; 'FullEM'};
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'Boundary', '', 'Non boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['location cat - 1 crossing trial age ' num2str(age_range(1)) '-' num2str(age_range(2)) ],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & CTRL MB] acc www (1 crossing trial)
a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select ==1);
WWW_Group{2} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==1);
WWW_Group{3} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==1);
WWW_Group{5} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==1);
WWW_Group{6} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==1);


MB_Group{1} = ctrl_Behavior_table.select_acc_what(ctrl_group_select ==1);
MB_Group{2} = ctrl_Behavior_table.select_acc_whatwhen(ctrl_group_select ==1);
MB_Group{3} = ctrl_Behavior_table.select_acc_where(ctrl_group_select ==1);
MB_Group{4} = ctrl_Behavior_table.select_acc_wherewhen(ctrl_group_select ==1);
MB_Group{5} = ctrl_Behavior_table.select_acc_whatwhere(ctrl_group_select ==1);
MB_Group{6} = ctrl_Behavior_table.select_acc_fullem(ctrl_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), 1:6, 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), 1:6, 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})

    % ranksum
%     [p(ti), h(ti)] = ranksum(round(WWW_Group{ti},3), round(MB_Group{ti},3))

end

% =======================================================================

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_color(1,:);  % [.5 .5 .5];

% draw bar
mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); %[.9 .5 .5]; % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, MBavg(bi)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where'; 'FullEM'};
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'CTRL Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['[ctrl bndry] 1 crossing trial age ' num2str(age_range(1)) '-' num2str(age_range(2)) ],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW & MB]  reaction time (1 crossing & right trial only)

a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group www_array WWW_Group_data


WWW_Group{1} = WWW_Behavior_table.cross1_rt_right_respond(WWW_group_select ==1);
WWW_Group{2} = [];
WWW_Group{3} = WWW_Behavior_table.cross1_rt_right_animal(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_rt_right_location(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_rt_right_respond(MB_group_select ==1);
MB_Group{2} = [];
MB_Group{3} = Behavior_table.select_rt_right_animal(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_rt_right_location(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:4
    if ismember(ti, [1,3,4])
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})
    end
end

% =======================================================================

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_rt_color(1,:);%[.6 .6 .6];

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:);%[.9 .6 .6]; % .2 .2. 2; .3 .4 .5 ];



% significance ==========================================================
for bi = 1:4
    if ismember(ti, [1,3,4])
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, WWWavg(bi)+ 1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');
    end
end

% =======================================================================

ylim([0 max(WWWavg+ 2)])


% labels
acc_Labels = {'Respond'; ''; 'What'; 'Where'};
xticklabels(acc_Labels)
ylabel('Reaction Time (sec)')

% title
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['RT (right & 1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB]  reaction time (1 crossing)

a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group


WWW_Group{1} = WWW_Behavior_table.cross1_rt_respond(WWW_group_select ==1);
WWW_Group{2} = [];
WWW_Group{3} = WWW_Behavior_table.cross1_rt_animal(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_rt_location(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_rt_respond(MB_group_select ==1);
MB_Group{2} = [];
MB_Group{3} = Behavior_table.select_rt_animal(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_rt_location(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:4
    if ismember(ti, [1,3,4])
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})
    end
end

% =======================================================================

% draw bar
www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_rt_color(1,:);%[.6 .6 .6];

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:);%[.9 .6 .6]; % .2 .2. 2; .3 .4 .5 ];


% significance ==========================================================
for bi = 1:4
    if ismember(ti, [1,3,4])
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, WWWavg(bi)+ 1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');
    end
end

% =======================================================================

ylim([0 max(WWWavg+ 2)])


% labels
acc_Labels = {'Respond'; ''; 'What'; 'Where'};
xticklabels(acc_Labels)
ylabel('Reaction Time (sec)')

% title
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['RT (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB]  log reaction time (1 crossing & right trial only)

a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group www_array WWW_Group_data


WWW_Group{1} = WWW_Behavior_table.cross1_log_rt_right_respond(WWW_group_select ==1);
WWW_Group{2} = [];
WWW_Group{3} = WWW_Behavior_table.cross1_log_rt_right_animal(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_log_rt_right_location(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_log_rt_right_respond(MB_group_select ==1);
MB_Group{2} = [];
MB_Group{3} = Behavior_table.select_log_rt_right_animal(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_log_rt_right_location(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:4
    if ismember(ti, [1,3,4])
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})
    end
end

% =======================================================================

% draw bar
www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_rt_color(1,:);%[.6 .6 .6];

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:);%[.9 .6 .6]; % .2 .2. 2; .3 .4 .5 ];



% significance ==========================================================
for bi = 1:4
    if ismember(ti, [1,3,4])
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, WWWavg(bi)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');
    end
end

% =======================================================================

ylim([0 max(WWWavg+ 1)])


% labels
acc_Labels = {'Respond'; ''; 'What'; 'Where'};
xticklabels(acc_Labels)
ylabel('ln(RT)')

% title
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['logRT (right & 1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB]  log reaction time (1 crossing)

a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group


WWW_Group{1} = WWW_Behavior_table.cross1_log_rt_respond(WWW_group_select ==1);
WWW_Group{2} = [];
WWW_Group{3} = WWW_Behavior_table.cross1_log_rt_animal(WWW_group_select ==1);
WWW_Group{4} = WWW_Behavior_table.cross1_log_rt_location(WWW_group_select ==1);


MB_Group{1} = Behavior_table.select_log_rt_respond(MB_group_select ==1);
MB_Group{2} = [];
MB_Group{3} = Behavior_table.select_log_rt_animal(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_log_rt_location(MB_group_select ==1);


% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [1,3,4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:4
    if ismember(ti, [1,3,4])
    [h(ti), p(ti)] = ttest2(WWW_Group{ti}, MB_Group{ti})
    end
end

% =======================================================================

% draw bar
www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_mb_rt_color(1,:);%[.6 .6 .6];

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:);%[.9 .6 .6]; % .2 .2. 2; .3 .4 .5 ];




% significance ==========================================================
for bi = 1:4
    if ismember(ti, [1,3,4])
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text(bi, WWWavg(bi)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');
    end
end

% =======================================================================

ylim([0 max(WWWavg+ 1)])


% labels
acc_Labels = {'Respond'; ''; 'What'; 'Where'};
xticklabels(acc_Labels)
ylabel('ln(RT)')

% title
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
title(['logRT (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW VS MB] log reaction time (1 crossing & right trial only)



a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = WWW_Behavior_table.cross1_log_rt_right_respond(WWW_group_select ==1);
% SB_Group{3} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [Behavior_table.select_log_rt_right_respond(MB_group_select ==1);];
% MB_Group{4} = [Behavior_table.select_ABD_within_acc(MB_group_select ==1); Behavior_table.select_MBD_within_acc(MB_group_select ==1)];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
% SB_Group_data = cell2mat(SB_Group');
% sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1], 'uni', 0)');
% [~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
% sb_group_compare = multcompare(sb_stats,"Display","off")
% 
% 
% MB_Group_data = cell2mat(MB_Group');
% mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2], 'uni', 0)');
% [~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
% mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:1
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_rt_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:1
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, SBavg(bi)+ 0.3, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([1.5 3])%max(SBavg+ 1)])


% labels
acc_Labels = {'Non-Boundary'; 'Boundary';};
xticks([1, 2])
xticklabels(acc_Labels)
ylabel('ln(RT)')


% title
% legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['RT - cross1 & right'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')






%% [WWW & MB] categorized location (all trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group = WWW_Behavior_table.acc_location_cat(WWW_group_select ==1);
MB_Group = Behavior_table.acc_location_cat(MB_group_select ==1);

Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

[h, p] = ttest2(WWW_Group, MB_Group)

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_mb_color;


ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1.5, max(avg+0.1), disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'Non boundary'; 'Boundary'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (all trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW & MB] categorized location (1 crossing trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group = WWW_Behavior_table.cross1_acc_location_cat(WWW_group_select ==1);
MB_Group = Behavior_table.select_acc_location_cat(MB_group_select ==1);

Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

[h, p] = ttest2(WWW_Group, MB_Group)

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_mb_color;

ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1.5, max(avg+0.1), disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'Non boundary'; 'Boundary'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (1 crossing trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [MB] categorized location  (all trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group = Behavior_table.all_ABD_acc_location_cat(MB_group_select ==1);
MB_Group = Behavior_table.all_MBD_acc_location_cat(MB_group_select ==1);

Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

[h, p] = ttest2(WWW_Group, MB_Group)

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = mb_color;

ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1.5, max(avg+0.1), disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'VISUAL'; 'MULTI'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (all trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [MB] categorized location  (1 crossing trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group = Behavior_table.select_ABD_acc_location_cat(MB_group_select ==1);
MB_Group = Behavior_table.select_MBD_acc_location_cat(MB_group_select ==1);

Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

[h, p] = ttest2(WWW_Group, MB_Group)

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = mb_color;

ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1.5, max(avg+0.1), disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'VISUAL'; 'MULTI'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (1 crossing trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW & MB-VB & MB-MB] categorized location (1 crossing trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.cross1_acc_location_cat(WWW_group_select ==1);
VB_Group = Behavior_table.select_ABD_acc_location_cat(MB_group_select ==1);
MB_Group = Behavior_table.select_MBD_acc_location_cat(MB_group_select ==1);

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.2)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.25)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.2)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (1 crossing trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB-VB & MB-MB] categorized location (all trial)

a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.acc_location_cat(WWW_group_select ==1);
VB_Group = Behavior_table.all_ABD_acc_location_cat(MB_group_select ==1);
MB_Group = Behavior_table.all_MBD_acc_location_cat(MB_group_select ==1);

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.2)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.25)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.2)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Categorized Location (all trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW VS MB] ACC (1 Crossing)



a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
SB_Group{3} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
SB_Group{5} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
SB_Group{7} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
SB_Group{9} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{2} = Behavior_table.select_acc_what(MB_group_select ==gi);
MB_Group{4} = Behavior_table.select_acc_whatwhen(MB_group_select ==gi);
MB_Group{6} = Behavior_table.select_acc_where(MB_group_select ==gi);
MB_Group{8} = Behavior_table.select_acc_wherewhen(MB_group_select ==gi);
MB_Group{10} = Behavior_table.select_acc_whatwhere(MB_group_select ==gi);
MB_Group{12} = Behavior_table.select_acc_fullem(MB_group_select ==gi);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end
%% [WWW VS MB+ctrl MB] ACC (1 Crossing)



a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
SB_Group{3} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
SB_Group{5} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
SB_Group{7} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
SB_Group{9} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{2} = [Behavior_table.select_acc_what(MB_group_select ==gi); ctrl_Behavior_table.select_acc_what(ctrl_group_select ==gi)];
MB_Group{4} = [Behavior_table.select_acc_whatwhen(MB_group_select ==gi); ctrl_Behavior_table.select_acc_whatwhen(ctrl_group_select ==gi)];
MB_Group{6} = [Behavior_table.select_acc_where(MB_group_select ==gi); ctrl_Behavior_table.select_acc_where(ctrl_group_select ==gi)];
MB_Group{8} = [Behavior_table.select_acc_wherewhen(MB_group_select ==gi); ctrl_Behavior_table.select_acc_wherewhen(ctrl_group_select ==gi)];
MB_Group{10} = [Behavior_table.select_acc_whatwhere(MB_group_select ==gi); ctrl_Behavior_table.select_acc_whatwhere(ctrl_group_select ==gi)];
MB_Group{12} = [Behavior_table.select_acc_fullem(MB_group_select ==gi); ctrl_Behavior_table.select_acc_fullem(ctrl_group_select ==gi)];




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing / MB(w/ctrl)'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW VS ctrl MB] ACC (1 Crossing)



a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
SB_Group{3} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
SB_Group{5} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
SB_Group{7} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
SB_Group{9} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{2} = ctrl_Behavior_table.select_acc_what(ctrl_group_select ==gi);
MB_Group{4} = ctrl_Behavior_table.select_acc_whatwhen(ctrl_group_select ==gi);
MB_Group{6} = ctrl_Behavior_table.select_acc_where(ctrl_group_select ==gi);
MB_Group{8} = ctrl_Behavior_table.select_acc_wherewhen(ctrl_group_select ==gi);
MB_Group{10} = ctrl_Behavior_table.select_acc_whatwhere(ctrl_group_select ==gi);
MB_Group{12} = ctrl_Behavior_table.select_acc_fullem(ctrl_group_select ==gi);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Boundary Ctrl'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end

%% [WWW VS ctrl MB] ACC (all Crossing)



a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = WWW_Behavior_table.acc_what(WWW_group_select==gi);
SB_Group{3} = WWW_Behavior_table.acc_whatwhen(WWW_group_select ==gi);
SB_Group{5} = WWW_Behavior_table.acc_where(WWW_group_select ==gi);
SB_Group{7} = WWW_Behavior_table.acc_wherewhen(WWW_group_select ==gi);
SB_Group{9} = WWW_Behavior_table.acc_whatwhere(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{2} = ctrl_Behavior_table.acc_what(ctrl_group_select ==gi);
MB_Group{4} = ctrl_Behavior_table.acc_whatwhen(ctrl_group_select ==gi);
MB_Group{6} = ctrl_Behavior_table.acc_where(ctrl_group_select ==gi);
MB_Group{8} = ctrl_Behavior_table.acc_wherewhen(ctrl_group_select ==gi);
MB_Group{10} = ctrl_Behavior_table.acc_whatwhere(ctrl_group_select ==gi);
MB_Group{12} = ctrl_Behavior_table.acc_fullem(ctrl_group_select ==gi);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end
%% [WWW VS MB] ACC (other  Crossing)



a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = WWW_Behavior_table.cross2_acc_what(WWW_group_select==gi);
SB_Group{3} = WWW_Behavior_table.cross2_acc_whatwhen(WWW_group_select ==gi);
SB_Group{5} = WWW_Behavior_table.cross2_acc_where(WWW_group_select ==gi);
SB_Group{7} = WWW_Behavior_table.cross2_acc_wherewhen(WWW_group_select ==gi);
SB_Group{9} = WWW_Behavior_table.cross2_acc_whatwhere(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.cross2_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{2} = Behavior_table.cross2_acc_what(MB_group_select ==gi);
MB_Group{4} = Behavior_table.cross2_acc_whatwhen(MB_group_select ==gi);
MB_Group{6} = Behavior_table.cross2_acc_where(MB_group_select ==gi);
MB_Group{8} = Behavior_table.cross2_acc_wherewhen(MB_group_select ==gi);
MB_Group{10} = Behavior_table.cross2_acc_whatwhere(MB_group_select ==gi);
MB_Group{12} = Behavior_table.cross2_acc_fullem(MB_group_select ==gi);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['2 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW & MB-VB & MB-MB] ACC (1 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = Behavior_table.select_ABD_acc_what(MB_group_select==gi);
SB_Group{5} = Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi);
SB_Group{8} = Behavior_table.select_ABD_acc_where(MB_group_select ==gi);
SB_Group{11} = Behavior_table.select_ABD_acc_wherewhen(MB_group_select ==gi);
SB_Group{14} = Behavior_table.select_ABD_acc_whatwhere(MB_group_select ==gi);
SB_Group{17} = Behavior_table.select_ABD_acc_fullem(MB_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{3} = Behavior_table.select_MBD_acc_what(MB_group_select ==gi);
MB_Group{6} = Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==gi);
MB_Group{9} = Behavior_table.select_MBD_acc_where(MB_group_select ==gi);
MB_Group{12} = Behavior_table.select_MBD_acc_wherewhen(MB_group_select ==gi);
MB_Group{15} = Behavior_table.select_MBD_acc_whatwhere(MB_group_select ==gi);
MB_Group{18} = Behavior_table.select_MBD_acc_fullem(MB_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
    [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['(www & multi) 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW & MB-VB & MB-MB (MB+Control)] ACC (1 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = [Behavior_table.select_ABD_acc_what(MB_group_select==gi); ctrl_Behavior_table.select_ABD_acc_what(ctrl_group_select==gi);];
SB_Group{5} = [Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_whatwhen(ctrl_group_select ==gi);];
SB_Group{8} = [Behavior_table.select_ABD_acc_where(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_where(ctrl_group_select ==gi);];
SB_Group{11} = [Behavior_table.select_ABD_acc_wherewhen(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_wherewhen(ctrl_group_select ==gi);];
SB_Group{14} = [Behavior_table.select_ABD_acc_whatwhere(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_whatwhere(ctrl_group_select ==gi);];
SB_Group{17} = [Behavior_table.select_ABD_acc_fullem(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_fullem(ctrl_group_select ==gi);];
% SB_Group{2} = []ctrl

% gi = 2
MB_Group{3} = [Behavior_table.select_MBD_acc_what(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_what(ctrl_group_select ==gi);];
MB_Group{6} = [Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_whatwhen(ctrl_group_select ==gi);];
MB_Group{9} = [Behavior_table.select_MBD_acc_where(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_where(ctrl_group_select ==gi);];
MB_Group{12} = [Behavior_table.select_MBD_acc_wherewhen(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_wherewhen(ctrl_group_select ==gi);];
MB_Group{15} = [Behavior_table.select_MBD_acc_whatwhere(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_whatwhere(ctrl_group_select ==gi);];
MB_Group{18} = [Behavior_table.select_MBD_acc_fullem(MB_group_select ==gi); ctrl_Behavior_table.select_MBD_acc_fullem(ctrl_group_select ==gi);];




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
    [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['(www & multi+control) 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end
%% [WWW & (ctrl) MB-VB & (ctrl) MB-MB] ACC (1 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = ctrl_Behavior_table.select_ABD_acc_what(ctrl_group_select==gi);
SB_Group{5} = ctrl_Behavior_table.select_ABD_acc_whatwhen(ctrl_group_select ==gi);
SB_Group{8} = ctrl_Behavior_table.select_ABD_acc_where(ctrl_group_select ==gi);
SB_Group{11} = ctrl_Behavior_table.select_ABD_acc_wherewhen(ctrl_group_select ==gi);
SB_Group{14} = ctrl_Behavior_table.select_ABD_acc_whatwhere(ctrl_group_select ==gi);
SB_Group{17} = ctrl_Behavior_table.select_ABD_acc_fullem(ctrl_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{3} = ctrl_Behavior_table.select_MBD_acc_what(ctrl_group_select ==gi);
MB_Group{6} = ctrl_Behavior_table.select_MBD_acc_whatwhen(ctrl_group_select ==gi);
MB_Group{9} = ctrl_Behavior_table.select_MBD_acc_where(ctrl_group_select ==gi);
MB_Group{12} = ctrl_Behavior_table.select_MBD_acc_wherewhen(ctrl_group_select ==gi);
MB_Group{15} = ctrl_Behavior_table.select_MBD_acc_whatwhere(ctrl_group_select ==gi);
MB_Group{18} = ctrl_Behavior_table.select_MBD_acc_fullem(ctrl_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
    [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['(www & multi control) 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW & MB-VB & MB-MB] ACC (1 Crossing) - location cat



a = figure();
a.Position = [1376 618 636 420] %[601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

% WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
% WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
% WWW_Group{7} = WWW_Behavior_table.cross1_acc_loc_cat_where(WWW_group_select ==gi);
WWW_Group{1} = WWW_Behavior_table.cross1_acc_loc_cat_wherewhen(WWW_group_select ==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_loc_cat_whatwhere(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_loc_cat_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% SB_Group{2} = Behavior_table.select_ABD_acc_what(MB_group_select==gi);
% SB_Group{5} = Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi);
% SB_Group{8} = Behavior_table.select_ABD_acc_loc_cat_where(MB_group_select ==gi);
SB_Group{2} = Behavior_table.select_ABD_acc_loc_cat_wherewhen(MB_group_select ==gi);
SB_Group{5} = Behavior_table.select_ABD_acc_loc_cat_whatwhere(MB_group_select ==gi);
SB_Group{8} = Behavior_table.select_ABD_acc_loc_cat_fullem(MB_group_select ==gi);
% SB_Group{2} = []

% gi = 2
% MB_Group{3} = Behavior_table.select_MBD_acc_what(MB_group_select ==gi);
% MB_Group{6} = Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==gi);
% MB_Group{9} = Behavior_table.select_MBD_acc_loc_cat_where(MB_group_select ==gi);
MB_Group{3} = Behavior_table.select_MBD_acc_loc_cat_wherewhen(MB_group_select ==gi);
MB_Group{6} = Behavior_table.select_MBD_acc_loc_cat_whatwhere(MB_group_select ==gi);
MB_Group{9} = Behavior_table.select_MBD_acc_loc_cat_fullem(MB_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 ], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 ], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 ], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:3
    % ttest
    [h1(ti), p1(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(SB_Group{(ti-1)*3+2}))
    [h2(ti), p2(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(MB_Group{ti*3}))
    [h3(ti), p3(ti)] = ttest2(rmmissing(SB_Group{(ti-1)*3+2}), rmmissing(MB_Group{ti*3}))
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:3
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(SBavg((bi-1)*3+2)+0.2);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 ], '--');
xticks([2 5 8 ])
xticklabels({'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['location cat - 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW & Multi & Multi_control] ACC (1 Crossing)





a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = Behavior_table.select_acc_what(MB_group_select==gi);
SB_Group{5} = Behavior_table.select_acc_whatwhen(MB_group_select ==gi);
SB_Group{8} = Behavior_table.select_acc_where(MB_group_select ==gi);
SB_Group{11} = Behavior_table.select_acc_wherewhen(MB_group_select ==gi);
SB_Group{14} = Behavior_table.select_acc_whatwhere(MB_group_select ==gi);
SB_Group{17} = Behavior_table.select_acc_fullem(MB_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{3} = ctrl_Behavior_table.select_acc_what(ctrl_group_select ==gi);
MB_Group{6} = ctrl_Behavior_table.select_acc_whatwhen(ctrl_group_select ==gi);
MB_Group{9} = ctrl_Behavior_table.select_acc_where(ctrl_group_select ==gi);
MB_Group{12} = ctrl_Behavior_table.select_acc_wherewhen(ctrl_group_select ==gi);
MB_Group{15} = ctrl_Behavior_table.select_acc_whatwhere(ctrl_group_select ==gi);
MB_Group{18} = ctrl_Behavior_table.select_acc_fullem(ctrl_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
    [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest2(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Multi boundary', '', 'Multi Control'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end



%% [WWW & MB-VB & MB-MB] ACC (1 Crossing) - wrong where but right location cat



a = figure();
a.Position = [1376 618 636 420] %[601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

% WWW_Group{1} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
% WWW_Group{4} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
% WWW_Group{7} = WWW_Behavior_table.cross1_acc_loc_cat_where(WWW_group_select ==gi);
WWW_Group{1} = WWW_Behavior_table.cross1_acc_wrong_loc_cat_wherewhen(WWW_group_select ==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_acc_wrong_loc_cat_whatwhere(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross1_acc_wrong_loc_cat_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% SB_Group{2} = Behavior_table.select_ABD_acc_what(MB_group_select==gi);
% SB_Group{5} = Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi);
% SB_Group{8} = Behavior_table.select_ABD_acc_loc_cat_where(MB_group_select ==gi);
SB_Group{2} = Behavior_table.select_ABD_acc_wrong_loc_cat_wherewhen(MB_group_select ==gi);
SB_Group{5} = Behavior_table.select_ABD_acc_wrong_loc_cat_whatwhere(MB_group_select ==gi);
SB_Group{8} = Behavior_table.select_ABD_acc_wrong_loc_cat_fullem(MB_group_select ==gi);
% SB_Group{2} = []

% gi = 2
% MB_Group{3} = Behavior_table.select_MBD_acc_what(MB_group_select ==gi);
% MB_Group{6} = Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==gi);
% MB_Group{9} = Behavior_table.select_MBD_acc_loc_cat_where(MB_group_select ==gi);
MB_Group{3} = Behavior_table.select_MBD_acc_wrong_loc_cat_wherewhen(MB_group_select ==gi);
MB_Group{6} = Behavior_table.select_MBD_acc_wrong_loc_cat_whatwhere(MB_group_select ==gi);
MB_Group{9} = Behavior_table.select_MBD_acc_wrong_loc_cat_fullem(MB_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 ], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 ], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 ], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:3
    % ttest
    [h1(ti), p1(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(SB_Group{(ti-1)*3+2}))
    [h2(ti), p2(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(MB_Group{ti*3}))
    [h3(ti), p3(ti)] = ttest2(rmmissing(SB_Group{(ti-1)*3+2}), rmmissing(MB_Group{ti*3}))
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:3
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(SBavg((bi-1)*3+2)+0.2);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 ], '--');
xticks([2 5 8 ])
xticklabels({'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['wrong where but right location cat - 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW & MB-VB & MB-MB] ACC (all)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = Behavior_table.all_ABD_acc_what(MB_group_select==gi);
SB_Group{5} = Behavior_table.all_ABD_acc_whatwhen(MB_group_select ==gi);
SB_Group{8} = Behavior_table.all_ABD_acc_where(MB_group_select ==gi);
SB_Group{11} = Behavior_table.all_ABD_acc_wherewhen(MB_group_select ==gi);
SB_Group{14} = Behavior_table.all_ABD_acc_whatwhere(MB_group_select ==gi);
SB_Group{17} = Behavior_table.all_ABD_acc_fullem(MB_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{3} = Behavior_table.all_MBD_acc_what(MB_group_select ==gi);
MB_Group{6} = Behavior_table.all_MBD_acc_whatwhen(MB_group_select ==gi);
MB_Group{9} = Behavior_table.all_MBD_acc_where(MB_group_select ==gi);
MB_Group{12} = Behavior_table.all_MBD_acc_wherewhen(MB_group_select ==gi);
MB_Group{15} = Behavior_table.all_MBD_acc_whatwhere(MB_group_select ==gi);
MB_Group{18} = Behavior_table.all_MBD_acc_fullem(MB_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest


    [h1(ti), p1(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(SB_Group{(ti-1)*3+2}))
    [h2(ti), p2(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(MB_Group{ti*3}))
    [h3(ti), p3(ti)] = ttest2(rmmissing(SB_Group{(ti-1)*3+2}), rmmissing(MB_Group{ti*3}))
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.1);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.2);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.1);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['all'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [WWW] ACC (0 1 2 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = WWW_Behavior_table.cross0_acc_what(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross0_acc_whatwhen(WWW_group_select ==gi);
WWW_Group{7} = WWW_Behavior_table.cross0_acc_where(WWW_group_select ==gi);
WWW_Group{10} = WWW_Behavior_table.cross0_acc_wherewhen(WWW_group_select ==gi);
WWW_Group{13} = WWW_Behavior_table.cross0_acc_whatwhere(WWW_group_select ==gi);
WWW_Group{16} = WWW_Behavior_table.cross0_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

SB_Group{2} = WWW_Behavior_table.cross1_acc_what(WWW_group_select==gi);
SB_Group{5} = WWW_Behavior_table.cross1_acc_whatwhen(WWW_group_select ==gi);
SB_Group{8} = WWW_Behavior_table.cross1_acc_where(WWW_group_select ==gi);
SB_Group{11} = WWW_Behavior_table.cross1_acc_wherewhen(WWW_group_select ==gi);
SB_Group{14} = WWW_Behavior_table.cross1_acc_whatwhere(WWW_group_select ==gi);
SB_Group{17} = WWW_Behavior_table.cross1_acc_fullem(WWW_group_select ==gi);
% SB_Group{2} = []

% gi = 2
MB_Group{3} = WWW_Behavior_table.cross2_acc_what(WWW_group_select ==gi);
MB_Group{6} = WWW_Behavior_table.cross2_acc_whatwhen(WWW_group_select ==gi);
MB_Group{9} = WWW_Behavior_table.cross2_acc_where(WWW_group_select ==gi);
MB_Group{12} = WWW_Behavior_table.cross2_acc_wherewhen(WWW_group_select ==gi);
MB_Group{15} = WWW_Behavior_table.cross2_acc_whatwhere(WWW_group_select ==gi);
MB_Group{18} = WWW_Behavior_table.cross2_acc_fullem(WWW_group_select ==gi);




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
    [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.2);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.2);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'0 crossing', '', '1 crossing', '', '2 crossing'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['WWW 0 1 2 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [MB] ACC (0 1 2 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = [Behavior_table.cross0_MBD_acc_what(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_what(MB_group_select ==gi)];
WWW_Group{4} = [Behavior_table.cross0_MBD_acc_whatwhen(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_whatwhen(MB_group_select ==gi)];
WWW_Group{7} = [Behavior_table.cross0_MBD_acc_where(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_where(MB_group_select ==gi)];
WWW_Group{10} = [Behavior_table.cross0_MBD_acc_wherewhen(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_wherewhen(MB_group_select ==gi)];
WWW_Group{13} = [Behavior_table.cross0_MBD_acc_whatwhere(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_whatwhere(MB_group_select ==gi)];
WWW_Group{16} =[Behavior_table.cross0_MBD_acc_fullem(MB_group_select ==gi); Behavior_table.cross0_ABD_acc_fullem(MB_group_select ==gi)];
% SB_Group{2} = []

SB_Group{2} = [Behavior_table.select_MBD_acc_what(MB_group_select==gi); Behavior_table.select_ABD_acc_what(MB_group_select==gi)];
SB_Group{5} = [Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==gi); Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi)];
SB_Group{8} = [Behavior_table.select_MBD_acc_where(MB_group_select ==gi); Behavior_table.select_ABD_acc_where(MB_group_select ==gi)];
SB_Group{11} = [Behavior_table.select_MBD_acc_wherewhen(MB_group_select ==gi); Behavior_table.select_ABD_acc_wherewhen(MB_group_select ==gi)];
SB_Group{14} = [Behavior_table.select_MBD_acc_whatwhere(MB_group_select ==gi); Behavior_table.select_ABD_acc_whatwhere(MB_group_select ==gi)];
SB_Group{17} = [Behavior_table.select_MBD_acc_fullem(MB_group_select ==gi); Behavior_table.select_ABD_acc_fullem(MB_group_select ==gi)];
% SB_Group{2} = []

% gi = 2
MB_Group{3} = [Behavior_table.cross2_MBD_acc_what(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_what(MB_group_select ==gi)];
MB_Group{6} = [Behavior_table.cross2_MBD_acc_whatwhen(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_whatwhen(MB_group_select ==gi)];
MB_Group{9} = [Behavior_table.cross2_MBD_acc_where(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_where(MB_group_select ==gi)];
MB_Group{12} = [Behavior_table.cross2_MBD_acc_wherewhen(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_wherewhen(MB_group_select ==gi)];
MB_Group{15} = [Behavior_table.cross2_MBD_acc_whatwhere(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_whatwhere(MB_group_select ==gi)];
MB_Group{18} = [Behavior_table.cross2_MBD_acc_fullem(MB_group_select ==gi); Behavior_table.cross2_ABD_acc_fullem(MB_group_select ==gi)];




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
% WWW_Group_data = cell2mat(WWW_Group');
% www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
% [~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
% www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
%     [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
%     [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 3%1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'0 Crossing', '', '1 Crossing', '', '2 Crossing'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['(Exp 1 - multi) 0 1 2 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end


%% [ctrl MB] ACC (0 1 2 Crossing)



a = figure();
a.Position = [601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1

WWW_Group{1} = [ctrl_Behavior_table.cross0_MBD_acc_what(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_what(MB_group_select ==gi)];
WWW_Group{4} = [ctrl_Behavior_table.cross0_MBD_acc_whatwhen(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_whatwhen(MB_group_select ==gi)];
WWW_Group{7} = [ctrl_Behavior_table.cross0_MBD_acc_where(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_where(MB_group_select ==gi)];
WWW_Group{10} = [ctrl_Behavior_table.cross0_MBD_acc_wherewhen(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_wherewhen(MB_group_select ==gi)];
WWW_Group{13} = [ctrl_Behavior_table.cross0_MBD_acc_whatwhere(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_whatwhere(MB_group_select ==gi)];
WWW_Group{16} =[ctrl_Behavior_table.cross0_MBD_acc_fullem(ctrl_group_select ==gi); ctrl_Behavior_table.cross0_ABD_acc_fullem(MB_group_select ==gi)];
% SB_Group{2} = []

SB_Group{2} = [ctrl_Behavior_table.select_MBD_acc_what(ctrl_group_select==gi); ctrl_Behavior_table.select_ABD_acc_what(MB_group_select==gi)];
SB_Group{5} = [ctrl_Behavior_table.select_MBD_acc_whatwhen(ctrl_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==gi)];
SB_Group{8} = [ctrl_Behavior_table.select_MBD_acc_where(ctrl_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_where(MB_group_select ==gi)];
SB_Group{11} = [ctrl_Behavior_table.select_MBD_acc_wherewhen(ctrl_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_wherewhen(MB_group_select ==gi)];
SB_Group{14} = [ctrl_Behavior_table.select_MBD_acc_whatwhere(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_whatwhere(MB_group_select ==gi)];
SB_Group{17} = [ctrl_Behavior_table.select_MBD_acc_fullem(MB_group_select ==gi); ctrl_Behavior_table.select_ABD_acc_fullem(MB_group_select ==gi)];
% SB_Group{2} = []

% gi = 2
MB_Group{3} = [ctrl_Behavior_table.cross2_MBD_acc_what(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_what(MB_group_select ==gi)];
MB_Group{6} = [ctrl_Behavior_table.cross2_MBD_acc_whatwhen(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_whatwhen(MB_group_select ==gi)];
MB_Group{9} = [ctrl_Behavior_table.cross2_MBD_acc_where(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_where(MB_group_select ==gi)];
MB_Group{12} = [ctrl_Behavior_table.cross2_MBD_acc_wherewhen(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_wherewhen(MB_group_select ==gi)];
MB_Group{15} = [ctrl_Behavior_table.cross2_MBD_acc_whatwhere(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_whatwhere(MB_group_select ==gi)];
MB_Group{18} = [ctrl_Behavior_table.cross2_MBD_acc_fullem(MB_group_select ==gi); ctrl_Behavior_table.cross2_ABD_acc_fullem(MB_group_select ==gi)];




% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
% WWW_Group_data = cell2mat(WWW_Group');
% www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 7 10 13 16], 'uni', 0)');
% [~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
% www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 8 11 14 17], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 9 12 15 18], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
%     [h1(ti), p1(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, SB_Group{(ti-1)*3+2})
%     [h2(ti), p2(ti)] = ttest2(WWW_Group{(ti-1)*3+1}, MB_Group{ti*3})
    [h3(ti), p3(ti)] = ttest(SB_Group{(ti-1)*3+2}, MB_Group{ti*3})
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:6
    for pp = 3%1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(MBavg(bi*3)+0.4);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(MBavg(bi*3)+0.3);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5 6.5 9.5 12.5 15.5], '--');
xticks([2 5 8 11 14 17])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'0 Crossing', '', '1 Crossing', '', '2 Crossing'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['(Exp 1 - multi) 0 1 2 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end

%% [MB] ACC (selected trials = cross 1)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = Behavior_table.select_ABD_acc_what(MB_group_select ==1);
SB_Group{3} = Behavior_table.select_ABD_acc_whatwhen(MB_group_select ==1);
SB_Group{5} = Behavior_table.select_ABD_acc_where(MB_group_select ==1);
SB_Group{7} = Behavior_table.select_ABD_acc_wherewhen(MB_group_select ==1);
SB_Group{9} = Behavior_table.select_ABD_acc_whatwhere(MB_group_select ==1);
SB_Group{11} = Behavior_table.select_ABD_acc_fullem(MB_group_select ==1);
% SB_Group{2} = []

MB_Group{2} = Behavior_table.select_MBD_acc_what(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_MBD_acc_whatwhen(MB_group_select ==1);
MB_Group{6} = Behavior_table.select_MBD_acc_where(MB_group_select ==1);
MB_Group{8} = Behavior_table.select_MBD_acc_wherewhen(MB_group_select ==1);
MB_Group{10} = Behavior_table.select_MBD_acc_whatwhere(MB_group_select ==1);
MB_Group{12} = Behavior_table.select_MBD_acc_fullem(MB_group_select ==1);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
%     [h(ti), p(ti)] = ttest(SB_Grosup{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
    [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, SBavg((bi-1)*2+1)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
xline([2.5 4.5 6.5 8.5 10.5], '--');
xticks([1.5 3.5 5.5 7.5 9.5 11.5])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})


ylabel('Accuracy')

legend({'Visual', '', 'Multi',}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [ctrl MB] ACC (selected trials = cross 1)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = ctrl_Behavior_table.select_ABD_acc_what(ctrl_group_select ==1);
SB_Group{3} = ctrl_Behavior_table.select_ABD_acc_whatwhen(ctrl_group_select ==1);
SB_Group{5} = ctrl_Behavior_table.select_ABD_acc_where(ctrl_group_select ==1);
SB_Group{7} = ctrl_Behavior_table.select_ABD_acc_wherewhen(ctrl_group_select ==1);
SB_Group{9} = ctrl_Behavior_table.select_ABD_acc_whatwhere(ctrl_group_select ==1);
SB_Group{11} = ctrl_Behavior_table.select_ABD_acc_fullem(ctrl_group_select ==1);
% SB_Group{2} = []

MB_Group{2} = ctrl_Behavior_table.select_MBD_acc_what(ctrl_group_select ==1);
MB_Group{4} = ctrl_Behavior_table.select_MBD_acc_whatwhen(ctrl_group_select ==1);
MB_Group{6} = ctrl_Behavior_table.select_MBD_acc_where(ctrl_group_select ==1);
MB_Group{8} = ctrl_Behavior_table.select_MBD_acc_wherewhen(ctrl_group_select ==1);
MB_Group{10} = ctrl_Behavior_table.select_MBD_acc_whatwhere(ctrl_group_select ==1);
MB_Group{12} = ctrl_Behavior_table.select_MBD_acc_fullem(ctrl_group_select ==1);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, SBavg((bi-1)*2+1)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.05])


% labels
xline([2.5 4.5 6.5 8.5 10.5], '--');
xticks([1.5 3.5 5.5 7.5 9.5 11.5])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})


ylabel('Accuracy')

legend({'Visual', '', 'Multi',}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['[ctrl bndry] 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [MB] ACC (other cross)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = Behavior_table.all_ABD_acc_what(MB_group_select ==1);
SB_Group{3} = Behavior_table.all_ABD_acc_whatwhen(MB_group_select ==1);
SB_Group{5} = Behavior_table.all_ABD_acc_where(MB_group_select ==1);
SB_Group{7} = Behavior_table.all_ABD_acc_wherewhen(MB_group_select ==1);
SB_Group{9} = Behavior_table.all_ABD_acc_whatwhere(MB_group_select ==1);
SB_Group{11} = Behavior_table.all_ABD_acc_fullem(MB_group_select ==1);
% SB_Group{2} = []

MB_Group{2} = Behavior_table.all_MBD_acc_what(MB_group_select ==1);
MB_Group{4} = Behavior_table.all_MBD_acc_whatwhen(MB_group_select ==1);
MB_Group{6} = Behavior_table.all_MBD_acc_where(MB_group_select ==1);
MB_Group{8} = Behavior_table.all_MBD_acc_wherewhen(MB_group_select ==1);
MB_Group{10} = Behavior_table.all_MBD_acc_whatwhere(MB_group_select ==1);
MB_Group{12} = Behavior_table.all_MBD_acc_fullem(MB_group_select ==1);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
%     [h(ti), p(ti)] = ttest(SB_Grosup{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
    [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, SBavg((bi-1)*2+1)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
xline([2.5 4.5 6.5 8.5 10.5], '--');
xticks([1.5 3.5 5.5 7.5 9.5 11.5])
xticklabels({'What'; 'What+When'; 'Where'; 'Where+When'; 'What+Where';  'FullEM'})


ylabel('Accuracy')

legend({'Visual', '', 'Multi',}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['all crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW VS MB] across within (all trial) 



a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = WWW_Behavior_table.across_acc(WWW_group_select ==1);
SB_Group{3} = WWW_Behavior_table.within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [Behavior_table.all_ABD_across_acc(MB_group_select ==1); Behavior_table.all_MBD_across_acc(MB_group_select ==1)];
MB_Group{4} = [Behavior_table.all_ABD_within_acc(MB_group_select ==1); Behavior_table.all_MBD_within_acc(MB_group_select ==1)];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['all trial'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW VS MB] across within (select trial) 


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = WWW_Behavior_table.cross1_across_acc(WWW_group_select ==1);
SB_Group{3} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [Behavior_table.select_ABD_across_acc(MB_group_select ==1); Behavior_table.select_MBD_across_acc(MB_group_select ==1)];
MB_Group{4} = [Behavior_table.select_ABD_within_acc(MB_group_select ==1); Behavior_table.select_MBD_within_acc(MB_group_select ==1)];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['all trial'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')
%% [WWW VS ctrl] across within (select trial) 


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = WWW_Behavior_table.cross1_across_acc(WWW_group_select ==1);
SB_Group{3} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [ctrl_Behavior_table.select_ABD_across_acc(ctrl_group_select ==1); ctrl_Behavior_table.select_MBD_across_acc(ctrl_group_select ==1)];
MB_Group{4} = [ctrl_Behavior_table.select_ABD_within_acc(ctrl_group_select ==1); ctrl_Behavior_table.select_MBD_within_acc(ctrl_group_select ==1)];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['all trial (ctrl)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [WWW VS MB+ctrl] across within (select trial) 


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = WWW_Behavior_table.cross1_across_acc(WWW_group_select ==1);
SB_Group{3} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [Behavior_table.select_ABD_across_acc(MB_group_select ==1); Behavior_table.select_MBD_across_acc(MB_group_select ==1); ctrl_Behavior_table.select_ABD_across_acc(ctrl_group_select ==1); ctrl_Behavior_table.select_MBD_across_acc(ctrl_group_select ==1)];
MB_Group{4} = [Behavior_table.select_ABD_within_acc(MB_group_select ==1); Behavior_table.select_MBD_within_acc(MB_group_select ==1); ctrl_Behavior_table.select_ABD_within_acc(ctrl_group_select ==1); ctrl_Behavior_table.select_MBD_within_acc(ctrl_group_select ==1)];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['all trial(multi+ctrl)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')





%% [MB] across within (all trial)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = Behavior_table.all_ABD_across_acc(MB_group_select ==1);
SB_Group{3} = Behavior_table.all_ABD_within_acc(MB_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = Behavior_table.all_MBD_across_acc(MB_group_select ==1);
MB_Group{4} = Behavior_table.all_MBD_within_acc(MB_group_select ==1);





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Visual Boundary', '', 'Audio + Visual boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['all trial'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [MB] across within (1 crossing trial)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = Behavior_table.select_ABD_across_acc(MB_group_select ==1);
SB_Group{3} = Behavior_table.select_ABD_within_acc(MB_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = Behavior_table.select_MBD_across_acc(MB_group_select ==1);
MB_Group{4} = Behavior_table.select_MBD_within_acc(MB_group_select ==1);





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Visual Boundary', '', 'Audio + Visual boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['1 cross trial'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [MB+ctrl] across within (1 crossing trial)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = [Behavior_table.select_ABD_across_acc(MB_group_select ==1); ctrl_Behavior_table.select_ABD_across_acc(ctrl_group_select ==1);];
SB_Group{3} = [Behavior_table.select_ABD_within_acc(MB_group_select ==1); ctrl_Behavior_table.select_ABD_within_acc(ctrl_group_select ==1);];

% SB_Group{2} = []

MB_Group{2} = [Behavior_table.select_MBD_across_acc(MB_group_select ==1); ctrl_Behavior_table.select_MBD_across_acc(ctrl_group_select ==1);];
MB_Group{4} = [Behavior_table.select_MBD_within_acc(MB_group_select ==1); ctrl_Behavior_table.select_MBD_within_acc(ctrl_group_select ==1);];





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Visual Boundary', '', 'Audio + Visual boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['1 cross trial (multi & ctrl)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [MB-ctrl] across within (1 crossing trial)


a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = ctrl_Behavior_table.select_ABD_across_acc(ctrl_group_select ==1);
SB_Group{3} = ctrl_Behavior_table.select_ABD_within_acc(ctrl_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = ctrl_Behavior_table.select_MBD_across_acc(ctrl_group_select ==1);
MB_Group{4} = ctrl_Behavior_table.select_MBD_within_acc(ctrl_group_select ==1);





% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h(ti), p(ti)] = ttest(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = mb_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = mb_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:2
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'Across'; 'Within';};
xticks([1.5, 3.5])
xticklabels(acc_Labels)
ylabel('Accuracy')


% title
legend({'Visual Boundary', '', 'Audio + Visual boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['1 cross trial(ctrl)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB-VB & MB-MB] across within (1 crossing trial)



a = figure();
a.Position = [1376 618 636 420] %[601 799 979 420];% [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1





WWW_Group{1} = WWW_Behavior_table.cross1_across_acc(WWW_group_select==gi);
WWW_Group{4} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==gi);


SB_Group{2} = Behavior_table.select_ABD_across_acc(MB_group_select==gi);
SB_Group{5} = Behavior_table.select_ABD_within_acc(MB_group_select ==gi);


% gi = 2
MB_Group{3} = Behavior_table.select_MBD_across_acc(MB_group_select ==gi);
MB_Group{6} = Behavior_table.select_MBD_within_acc(MB_group_select ==gi);



% avg & err
[WWWavg, WWWerr] = jh_mean_err(WWW_Group);
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
WWW_Group_data = cell2mat(WWW_Group');
www_array = cell2mat(arrayfun(@(x) repmat(x, size(WWW_Group{x})), [1 4 ], 'uni', 0)');
[~,tbl,www_stats] = anova1(WWW_Group_data,www_array,'off');
www_group_compare = multcompare(www_stats,"Display","off")

SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [2 5 ], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [3 6 ], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:2
    % ttest
    [h1(ti), p1(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(SB_Group{(ti-1)*3+2}))
    [h2(ti), p2(ti)] = ttest2(rmmissing(WWW_Group{(ti-1)*3+1}), rmmissing(MB_Group{ti*3}))
    [h3(ti), p3(ti)] = ttest(rmmissing(SB_Group{(ti-1)*3+2}), rmmissing(MB_Group{ti*3}))
    
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar

www_fig_bar = jh_bar(WWWavg, WWWerr);  hold on;
www_fig_bar.FaceColor = em_vb_mb_color(1,:);

sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_vb_mb_color(2,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_vb_mb_color(3,:); % .2 .2. 2; .3 .4 .5 ];



for bi = 1:2
    for pp = 1:3
        if pp ==1
            ttp = p1(bi);
            xtp = (bi-1)*3+1.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        elseif pp ==2
            ttp = p2(bi);
            xtp = (bi-1)*3+2; xtpg = [xtp-0.75 xtp+0.75];
            ytp = max(SBavg((bi-1)*3+2)+0.2);
        elseif pp == 3
            ttp = p3(bi);
            xtp = (bi-1)*3+2.5; xtpg = [xtp-0.35 xtp+0.35];
            ytp = max(SBavg((bi-1)*3+2)+0.15);
        end
        % ttp = p;
        if ttp < 0.001
            title_groupdif = [ num2str(ttp,3) '***)' ];
            disp = '***';
        elseif ttp < 0.01
            title_groupdif = [ num2str(ttp,3) '**)' ];
            disp = '**';
        elseif ttp < 0.05
            title_groupdif = [ num2str(ttp,3) '*)' ];
            disp = '*';
        elseif ttp < 0.1
            title_groupdif = [ num2str(ttp,3) '+)' ];
            disp = '+';
        else
            title_groupdif = num2str(ttp,3);
            disp = '';
        end

        text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

        if ttp < 0.1
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
        end

        hold on;
    end
end






% =======================================================================

ylim([0 1.04])%max(MBavg+ 0.2)])


% labels
xline([3.5  ], '--');
xticks([2 5 ])
xticklabels({'Across'; 'Within'})
% acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
% xticklabels(acc_Labels)
ylabel('Accuracy')

% title
% legend({'Non Boundary', '', 'Boundary'});
legend({'Non Boundary', '', 'Visual', '', 'Visual + Audio'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
    title(['across within - 1 crossing'],'FontWeight','bold')

set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


% end



%% [WWW VS MB] Location chunking (1 crossing)

a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = [WWW_Behavior_table.cross1_loc_chunking(WWW_group_select ==1);];


MB_Group = [Behavior_table.select_loc_chunking(MB_group_select ==1);];



Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

% % avg & err
% [SBavg, SBerr] = jh_mean_err(SB_Group);
% [MBavg, MBerr] = jh_mean_err(MB_Group);

% 
% for ti = 1:1
%     % ttest
%     [h(ti), p(ti)] = ttest2(WWW_Group{(ti-1)*2+1}, MB_Group{ti*2})
%     % ranksum
% %     [p(ti), h(ti)] = signrank(round(WWW_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
% end


for ti = 1:1
    % ttest
    [h(ti), p(ti)] = ttest2(WWW_Group, MB_Group)
    % ranksum
%     [p(ti), h(ti)] = signrank(round(WWW_Group,3), round(MB_Group,3))
end


% 
% [h, p] = ttest2(WWW_Group, MB_Group)
% 



fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_mb_color;

% sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
% sb_fig_bar.FaceColor = [.6 .6 .6];
% 
% mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
% mb_fig_bar.FaceColor = [.9 .6 .4]; % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:1
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, max(avg)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.15])


% labels
acc_Labels = {'WWW'; 'Boundary'};
xticklabels(acc_Labels)
ylabel('location chunking')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['Location Chunking (1 crossing)'],'FontWeight','bold')



%% [MB] visual vs audio+visual Location chunking (1 crossing)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group = [Behavior_table.select_ABD_loc_chunking(MB_group_select ==1);];


MB_Group = [Behavior_table.select_MBD_loc_chunking(MB_group_select ==1);];


Two_Group = [{SB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

% % avg & err
% [SBavg, SBerr] = jh_mean_err(SB_Group);
% [MBavg, MBerr] = jh_mean_err(MB_Group);

% 
% for ti = 1:1
%     % ttest
%     [h(ti), p(ti)] = ttest2(WWW_Group{(ti-1)*2+1}, MB_Group{ti*2})
%     % ranksum
% %     [p(ti), h(ti)] = signrank(round(WWW_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
% end


for ti = 1:1
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group, MB_Group)
    % ranksum
%     [p(ti), h(ti)] = signrank(round(WWW_Group,3), round(MB_Group,3))
end


% 
% [h, p] = ttest2(WWW_Group, MB_Group)
% 



fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = mb_color;

% sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
% sb_fig_bar.FaceColor = [.6 .6 .6];
% 
% mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
% mb_fig_bar.FaceColor = [.9 .6 .4]; % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:1
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, max(avg)+ 0.1, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 1.15])


% labels
acc_Labels = {'VISUAL'; 'MULTI'};
xticklabels(acc_Labels)
ylabel('location chunking')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['Location Chunking (1 crossing)'],'FontWeight','bold')




%% [WWW & MB-VB & MB-MB] Location chunking (1 crossing)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.cross1_loc_chunking(WWW_group_select ==1);
VB_Group = Behavior_table.select_ABD_loc_chunking(MB_group_select ==1);
MB_Group = Behavior_table.select_MBD_loc_chunking(MB_group_select ==1);

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.2)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.25)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.2)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Location Chunking (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')
%% [WWW & MB-VB & MB-MB (mb & ctrl)] Location chunking (1 crossing)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.cross1_loc_chunking(WWW_group_select ==1);
VB_Group = [Behavior_table.select_ABD_loc_chunking(MB_group_select ==1); ctrl_Behavior_table.select_ABD_loc_chunking(ctrl_group_select ==1);];
MB_Group = [Behavior_table.select_MBD_loc_chunking(MB_group_select ==1); ctrl_Behavior_table.select_MBD_loc_chunking(ctrl_group_select ==1);];

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.2)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.25)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.2)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Location Chunking (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB-VB & MB-MB] Wrong Category (all)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.all_wrong_cat(WWW_group_select ==1);
VB_Group = Behavior_table.all_ABD_wrong_cat(MB_group_select ==1);
MB_Group = Behavior_table.all_MBD_wrong_cat(MB_group_select ==1);

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.2)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.25)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.2)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Wrong Category (all trial)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB-VB & MB-MB] Wrong Category (1 crossing)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = WWW_Behavior_table.cross1_wrong_cat(WWW_group_select ==1);
VB_Group = Behavior_table.select_ABD_wrong_cat(MB_group_select ==1);
MB_Group = Behavior_table.select_MBD_wrong_cat(MB_group_select ==1);

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.25)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.3)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.25)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Wrong Category (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [MB-VB & MB-MB] Wrong Category (1 crossing)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

% WWW_Group = WWW_Behavior_table.cross1_wrong_cat(WWW_group_select ==1);
VB_Group = Behavior_table.select_ABD_wrong_cat(MB_group_select ==1);
MB_Group = Behavior_table.select_MBD_wrong_cat(MB_group_select ==1);

Three_Group = [ {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


% [h1, p1] = ttest2(WWW_Group, VB_Group)
% [h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = mb_color;

for pp = 1:1
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.25)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.3)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.25)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 1.19])%max(avg+ 0.2)])


% labels
acc_Labels = {'WWW'; 'Visual'; 'Multi'};
xticklabels(acc_Labels)
ylabel('Accuracy')


title(['Wrong Category (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [WWW & MB] Wrong Category (1 crossing)


a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group

WWW_Group = WWW_Behavior_table.cross1_wrong_cat(WWW_group_select ==1);
MB_Group = [Behavior_table.select_ABD_wrong_cat(MB_group_select ==1); Behavior_table.select_MBD_wrong_cat(MB_group_select ==1)];

Two_Group = [{WWW_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Two_Group);

[h, p] = ttest2(WWW_Group, MB_Group)

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_mb_color;


ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1.5, max(avg+0.1), disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'WCDI'; 'Boundary'};
xticklabels(acc_Labels)
ylabel('Accuracy')
title(['Wrong Category (1 crossing)'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [Interference] acc (www & MB) (all cat1 cat2)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat1(WWW_group_select ==1)];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat2(WWW_group_select ==1)];

Three_Group = [{TB_Group}, {[]} ,{SB_Group}, {MB_Group}];


% [h1, p1] = ttest2(TB_Group, SB_Group)
% [h2, p2] = ttest2(TB_Group, MB_Group)
[h3, p3] = ttest(SB_Group, MB_Group)

[avg, err] = jh_mean_err(Three_Group);

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = Inter_Color;

for pp = 3
    if pp ==1 
        ttp = p1;
        xtp = 2; xtpg = [1 2];
        ytp = max(avg(pp)+0.1);
    elseif pp ==2
        ttp = p2;
        xtp = 2.5; xtpg = [1 3];
        ytp = max(avg(pp)+0.15);       
    elseif pp == 3
        ttp = p3;
        xtp = 3.5; xtpg = [3 4];
        ytp = max(avg(pp)+0.1);
    end
% ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
%     plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end

end

% =======================================================================

ylim([0.5 1])


% labels
acc_Labels = {'all'; ''; '1 Cat'; '2 Cat';};
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb+www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [Interference] acc (www & MB) (cat1 cat2)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


% TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat1(WWW_group_select ==1)];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat2(WWW_group_select ==1)];

Three_Group = [{SB_Group}, {MB_Group}];


% [h1, p1] = ttest2(TB_Group, SB_Group)
% [h2, p2] = ttest2(TB_Group, MB_Group)
[h3, p3] = ttest(SB_Group, MB_Group)

[avg, err] = jh_mean_err(Three_Group);

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = Inter_Color_cat12;

for pp = 1
    if pp ==1 
        ttp = p3;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.1);
%     elseif pp ==2
%         ttp = p2;
%         xtp = 2.5; xtpg = [1 3];
%         ytp = max(avg(pp)+0.15);       
%     elseif pp == 3
%         ttp = p3;
%         xtp = 3.5; xtpg = [3 4];
%         ytp = max(avg(pp)+0.1);
    end
% ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end

end

% =======================================================================

ylim([0.5 1])


% labels
acc_Labels = {'Non-boundary'; 'Boundary';};
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb+www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [Interference] acc (MB) (all cat1 cat2)


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); ];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1);];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1); ];

Three_Group = [{TB_Group}, {[]} ,{SB_Group}, {MB_Group}];


% [h1, p1] = ttest2(TB_Group, SB_Group)
% [h2, p2] = ttest2(TB_Group, MB_Group)
[h3, p3] = ttest(SB_Group, MB_Group)

[avg, err] = jh_mean_err(Three_Group);

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = Inter_Color;

for pp = 3
    if pp ==1 
        ttp = p1;
        xtp = 2; xtpg = [1 2];
        ytp = max(avg(pp)+0.1);
    elseif pp ==2
        ttp = p2;
        xtp = 2.5; xtpg = [1 3];
        ytp = max(avg(pp)+0.15);       
    elseif pp == 3
        ttp = p3;
        xtp = 3.5; xtpg = [3 4];
        ytp = max(avg(pp)+0.1);
    end
% ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
%     plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end

end

% =======================================================================

ylim([0.5 1])


% labels
acc_Labels = {'all'; ''; '1 Cat'; '2 Cat';};
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')




%% [Interference] acc (www & MB) (cat1 cat2) Box plot


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


% TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat1(WWW_group_select ==1)];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat2(WWW_group_select ==1)];

Three_Group = [SB_Group, MB_Group];


[h3, p3] = ttest(SB_Group, MB_Group)


boxplot(Three_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    if j == 1
        tj=2;
    elseif j== 2
        tj = 1;
    end
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(tj,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group))], SB_Group);
s1.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;

s2 = scatter(ones(size(MB_Group))*2, MB_Group);
s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);


for pp = 3
    ttp = p3;
    xtp = 1.5; xtpg = [1 2];
    ytp = max(nanmean(SB_Group)+0.3);
    if ttp < 0.005
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end

    text(xtp, ytp, disp, 'FontSize', 20,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

    if ttp < 0.05
            plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
    end

end

% =======================================================================

ylim([0.2 1.2])


% labels
acc_Labels = {'1 Cat'; '2 Cat'; };
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb+www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [Interference] acc (MB) (cat1 cat2) Box plot


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


% TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1);];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1);];

Three_Group = [SB_Group, MB_Group];


[h3, p3] = ttest(SB_Group, MB_Group)


boxplot(Three_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    if j == 1
        tj=2;
    elseif j== 2
        tj = 1;
    end
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(tj,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group))], SB_Group);
s1.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;

s2 = scatter(ones(size(MB_Group))*2, MB_Group);
s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);


for pp = 3
    ttp = p3;
    xtp = 1.5; xtpg = [1 2];
    ytp = max(nanmean(SB_Group)+0.35);
    if ttp < 0.005
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end

    text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

    if ttp < 0.05
        %     plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
    end

end

% =======================================================================

ylim([0.2 1.2])


% labels
acc_Labels = {'1 Cat'; '2 Cat'; };
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')


%% [Interference] acc (www) (cat1 cat2) Box plot


a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


% TB_Group = [Behavior_table.inter_acc(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [WWW_Behavior_table.inter_acc_cat1(WWW_group_select ==1);];


MB_Group = [WWW_Behavior_table.inter_acc_cat2(WWW_group_select ==1);];

Three_Group = [SB_Group, MB_Group];


[h3, p3] = ttest(SB_Group, MB_Group)


boxplot(Three_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    if j == 1
        tj=2;
    elseif j== 2
        tj = 1;
    end
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(tj,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group))], SB_Group);
s1.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;

s2 = scatter(ones(size(MB_Group))*2, MB_Group);
s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);


for pp = 3
    ttp = p3;
    xtp = 1.5; xtpg = [1 2];
    ytp = max(nanmean(SB_Group)+0.35);
    if ttp < 0.005
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end

    text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

    if ttp < 0.05
        %     plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
    end

end

% =======================================================================

ylim([0.2 1.2])


% labels
acc_Labels = {'1 Cat'; '2 Cat'; };
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['WWW age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [Interference] Category user (WWW + MB)

a = figure();
a.Position =[2655 612 200 324];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


SB_Group = [Behavior_table.inter_bnd_use_index(MB_group_select ==1); WWW_Behavior_table.inter_bnd_use_index(WWW_group_select ==1)];
TB_Group = zeros(size(SB_Group));

boxplot(SB_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(j,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group(SB_Group>0)))], SB_Group(SB_Group>0));
s1.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;


s2 = scatter([ones(size(SB_Group(SB_Group<=0)))], SB_Group(SB_Group<=0));
s2.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

yline(0)

ylim([-0.35 0.55])
% s2 = scatter(ones(size(MB_Group))*2, MB_Group);
% s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
% s2.MarkerFaceAlpha = .2;
% s2.MarkerEdgeAlpha = 0;

% plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);

[h, p] = ttest(SB_Group, TB_Group)
ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1, max(SB_Group) + 0.1, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');


xticklabels({'2 cat - 1 cat'})
title(['mb+www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')

%% [Interference] Category user (MB)

a = figure();
a.Position =[2655 612 200 324];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


SB_Group = [Behavior_table.inter_bnd_use_index(MB_group_select ==1)];
TB_Group = zeros(size(SB_Group));

boxplot(SB_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(j,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group(SB_Group>0)))], SB_Group(SB_Group>0));
s1.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;


s2 = scatter([ones(size(SB_Group(SB_Group<=0)))], SB_Group(SB_Group<=0));
s2.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

yline(0)

ylim([-0.35 0.55])
% s2 = scatter(ones(size(MB_Group))*2, MB_Group);
% s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
% s2.MarkerFaceAlpha = .2;
% s2.MarkerEdgeAlpha = 0;

% plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);

[h, p] = ttest(SB_Group, TB_Group)
ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1, max(SB_Group) + 0.1, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');


xticklabels({'2 cat - 1 cat'})
title(['mb age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [Interference] Category user (WWW )

a = figure();
a.Position =[2655 612 200 324];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


SB_Group = [WWW_Behavior_table.inter_bnd_use_index(WWW_group_select ==1)];
TB_Group = zeros(size(SB_Group));

boxplot(SB_Group,'Symbol','', 'BoxStyle','outline');

fig_box = findobj(gca,'Tag','Box');
for j=1:length(fig_box)
    patch(get(fig_box(j),'XData'),get(fig_box(j),'YData'),Inter_Color_cat12(j,:),'FaceAlpha',0.2);
end

set(fig_box, 'LineWidth', 1.5)

h = findobj(gca, 'Type', 'line');
set(h, 'LineWidth', 1.5, 'Color', [.5 .5 .5])


hold on;

s1 = scatter([ones(size(SB_Group(SB_Group>0)))], SB_Group(SB_Group>0));
s1.MarkerFaceColor = Inter_Color_cat12_g(2,:);
s1.MarkerFaceAlpha = .2;
s1.MarkerEdgeAlpha = 0;


s2 = scatter([ones(size(SB_Group(SB_Group<=0)))], SB_Group(SB_Group<=0));
s2.MarkerFaceColor = Inter_Color_cat12_g(1,:);
s2.MarkerFaceAlpha = .2;
s2.MarkerEdgeAlpha = 0;

yline(0)

ylim([-0.35 0.55])
% s2 = scatter(ones(size(MB_Group))*2, MB_Group);
% s2.MarkerFaceColor = Inter_Color_cat12_g(2,:);
% s2.MarkerFaceAlpha = .2;
% s2.MarkerEdgeAlpha = 0;

% plot([1, 2], Three_Group, 'Color', [.7 .7 .7]);

[h, p] = ttest(SB_Group, TB_Group)
ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(1, max(SB_Group) + 0.1, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');


xticklabels({'2 cat - 1 cat'})
title(['www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [Interference] rt (www & MB) (all cat1 cat2) (Dosen't exist..)

a = figure();
a.Position = [2655 612 337 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group TB_Group Three_Group avg err


TB_Group = [Behavior_table.inter_rt(MB_group_select ==1); WWW_Behavior_table.inter_acc(WWW_group_select ==1)];


SB_Group = [Behavior_table.inter_acc_cat1(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat1(WWW_group_select ==1)];


MB_Group = [Behavior_table.inter_acc_cat2(MB_group_select ==1); WWW_Behavior_table.inter_acc_cat2(WWW_group_select ==1)];

Three_Group = [{TB_Group}, {[]} ,{SB_Group}, {MB_Group}];


% [h1, p1] = ttest2(TB_Group, SB_Group)
% [h2, p2] = ttest2(TB_Group, MB_Group)
[h3, p3] = ttest(SB_Group, MB_Group)

[avg, err] = jh_mean_err(Three_Group);

fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = Inter_Color;

for pp = 3
    if pp ==1 
        ttp = p1;
        xtp = 2; xtpg = [1 2];
        ytp = max(avg(pp)+0.1);
    elseif pp ==2
        ttp = p2;
        xtp = 2.5; xtpg = [1 3];
        ytp = max(avg(pp)+0.15);       
    elseif pp == 3
        ttp = p3;
        xtp = 3.5; xtpg = [3 4];
        ytp = max(avg(pp)+0.1);
    end
% ttp = p;
if ttp < 0.005
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
%     plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end

end

% =======================================================================

ylim([0.5 1])


% labels
acc_Labels = {'all'; ''; '1 Cat'; '2 Cat';};
xticklabels(acc_Labels)

ylabel('Accuracy')


% title
% legend({'Visual Boundary', '', 'Audio + Visual boundary'});
title(['mb+www age ' num2str(age_range(1)) '-' num2str(age_range(2))],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB] trial 1 2 3 - overall rt (1 crossing)







plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_log_rt_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_log_rt_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_trial3_respond(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.ABB_log_rt_trial1_respond(MB_group_select));nanmean(Behavior_table.ABB_log_rt_trial2_respond(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_trial3_respond(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_trial1_respond(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_trial2_respond(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_trial3_respond(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(3, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));


xlim([0.7 3.3])
ylim([1 2.6])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('ln(RT)')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['Overall RT (cross 1)'],'FontWeight','bold')

%% [WWW & MB] trial 1 2 3 - overall rt (1 crossing & right)




selected_group{1,1} = rmmissing(Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));
selected_group{1,2} = rmmissing(Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group{1,3} = rmmissing(Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));
selected_group{2,1} = rmmissing(Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));
selected_group{2,2} = rmmissing(Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));
selected_group{2,3} = rmmissing(Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));
selected_group{3,1} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));
selected_group{3,2} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select));
selected_group{3,3} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));


selected_group{4,1} = [selected_group{1,1}; selected_group{2,1}];
selected_group{4,2} = [selected_group{1,2}; selected_group{2,2}];
selected_group{4,3} = [selected_group{1,3}; selected_group{2,3}];



plot_trial_range = 1:3;
selected_data1 = [nanmean(selected_group{4,1});nanmean(selected_group{4,2}); nanmean(selected_group{4,3});];

% selected_data1 = [nanmean(Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));];
% selected_data2 = [nanmean(Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_mb_color(2, :));
hold on
% line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));



for si = 1:3
    [h1(si), p1(si)] = ttest2(selected_group{1,si}, selected_group{2,si})
    [h2(si), p2(si)] = ttest2(selected_group{2,si}, selected_group{3,si})
    [h3(si), p3(si)] = ttest2(selected_group{1,si}, selected_group{3,si})
end






xlim([0.7 3.3])
ylim([1.65 2.55])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('ln(RT)')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['Overall RT (cross 1 & right)'],'FontWeight','bold')



%% [WWW & MB] trial 1 2 3 - overall rt (1 crossing & right) AAB ABB Spilit




selected_group{1,1} = rmmissing(Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));
selected_group{1,2} = rmmissing(Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group{1,3} = rmmissing(Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));
selected_group{2,1} = rmmissing(Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));
selected_group{2,2} = rmmissing(Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));
selected_group{2,3} = rmmissing(Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));
selected_group{3,1} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));
selected_group{3,2} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select));
selected_group{3,3} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));



plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_mb_rt_color(2, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));



for si = 1:3
    [h1(si), p1(si)] = ttest2(selected_group{1,si}, selected_group{2,si})
    [h2(si), p2(si)] = ttest2(selected_group{2,si}, selected_group{3,si})
    [h3(si), p3(si)] = ttest2(selected_group{1,si}, selected_group{3,si})
end






xlim([0.7 3.3])
ylim([1.65 2.55])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('log RT')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['Overall RT (cross 1 & right)'],'FontWeight','bold')
%% [WWW & MB(CTRL)] trial 1 2 3 - overall rt (1 crossing & right) AAB ABB Spilit




selected_group{1,1} = rmmissing(ctrl_Behavior_table.AAB_log_rt_right_trial1_respond(ctrl_group_select));
selected_group{1,2} = rmmissing(ctrl_Behavior_table.AAB_log_rt_right_trial2_respond(ctrl_group_select));
selected_group{1,3} = rmmissing(ctrl_Behavior_table.AAB_log_rt_right_trial3_respond(ctrl_group_select));
selected_group{2,1} = rmmissing(ctrl_Behavior_table.ABB_log_rt_right_trial1_respond(ctrl_group_select));
selected_group{2,2} = rmmissing(ctrl_Behavior_table.ABB_log_rt_right_trial2_respond(ctrl_group_select));
selected_group{2,3} = rmmissing(ctrl_Behavior_table.ABB_log_rt_right_trial3_respond(ctrl_group_select));
selected_group{3,1} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));
selected_group{3,2} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select));
selected_group{3,3} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));



plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(3, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));



for si = 1:3
    [h1(si), p1(si)] = ttest2(selected_group{1,si}, selected_group{2,si})
    [h2(si), p2(si)] = ttest2(selected_group{2,si}, selected_group{3,si})
    [h3(si), p3(si)] = ttest2(selected_group{1,si}, selected_group{3,si})
end






xlim([0.7 3.3])
ylim([1.65 2.55])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('log RT')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['ctrl Overall RT (cross 1 & right)'],'FontWeight','bold')




%% [MB - VB VS MB] trial 1 2 3 - overall rt (1 crossing & right) AAB ABB Spilit




selected_group{1,1} = rmmissing(Behavior_table.AAB_ABD_log_rt_right_trial1_respond(MB_group_select));
selected_group{1,2} = rmmissing(Behavior_table.AAB_ABD_log_rt_right_trial2_respond(MB_group_select));
selected_group{1,3} = rmmissing(Behavior_table.AAB_ABD_log_rt_right_trial3_respond(MB_group_select));
selected_group{2,1} = rmmissing(Behavior_table.AAB_MBD_log_rt_right_trial1_respond(MB_group_select));
selected_group{2,2} = rmmissing(Behavior_table.AAB_MBD_log_rt_right_trial2_respond(MB_group_select));
selected_group{2,3} = rmmissing(Behavior_table.AAB_MBD_log_rt_right_trial3_respond(MB_group_select));
% selected_group{3,1} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));
% selected_group{3,2} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select));
% selected_group{3,3} = rmmissing(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));



plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_ABD_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_ABD_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_ABD_log_rt_right_trial3_respond(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.AAB_MBD_log_rt_right_trial1_respond(MB_group_select));nanmean(Behavior_table.AAB_MBD_log_rt_right_trial2_respond(MB_group_select)); nanmean(Behavior_table.AAB_MBD_log_rt_right_trial3_respond(MB_group_select));];
% selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(3, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
% hold on
% line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));



for si = 1:3
    [h1(si), p1(si)] = ttest2(selected_group{1,si}, selected_group{2,si})
%     [h2(si), p2(si)] = ttest2(selected_group{2,si}, selected_group{3,si})
%     [h3(si), p3(si)] = ttest2(selected_group{1,si}, selected_group{3,si})
end






xlim([0.7 3.3])
ylim([1.65 2.55])



legend_h = legend({'VB', 'MB'}, 'EdgeColor', 'none', 'Location', 'Southeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('log RT')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['aab Overall RT (cross 1 & right)'],'FontWeight','bold')


%% [MB] boundary before after - overall rt (1 crossing & right)





selected_group_aa{1,1} = (Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));
selected_group_aa{1,2} = (Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group_aa{1,3} = (Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));
selected_group_aa{1,4} = (Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));

ind_remove = isnan(selected_group_aa{1,1}) | isnan(selected_group_aa{1,2});
selected_group_aa{1,1}(ind_remove) = [];
selected_group_aa{1,2}(ind_remove) = [];
ind_remove = isnan(selected_group_aa{1,3}) | isnan(selected_group_aa{1,4});
selected_group_aa{1,3}(ind_remove) = [];
selected_group_aa{1,4}(ind_remove) = [];

selected_group_aa{2,1} = selected_group_aa{1,1} - selected_group_aa{1,2};
selected_group_aa{2,2} = selected_group_aa{1,3} - selected_group_aa{1,4};


selected_group_ab{1,1} = (Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group_ab{1,2} = (Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));
selected_group_ab{1,3} = (Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));
selected_group_ab{1,4} = (Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));

ind_remove = isnan(selected_group_ab{1,1}) | isnan(selected_group_ab{1,2});
selected_group_ab{1,1}(ind_remove) = [];
selected_group_ab{1,2}(ind_remove) = [];
ind_remove = isnan(selected_group_ab{1,3}) | isnan(selected_group_ab{1,4});
selected_group_ab{1,3}(ind_remove) = [];
selected_group_ab{1,4}(ind_remove) = [];

selected_group_ab{2,1} = selected_group_ab{1,1} - selected_group_ab{1,2};
selected_group_ab{2,2} = selected_group_ab{1,3} - selected_group_ab{1,4};





a = figure();
a.Position = [1053 623 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

SB_Group{1} = [selected_group_aa{2,1}; selected_group_aa{2,2}];
% SB_Group{3} = WWW_Behavior_table.cross1_within_acc(WWW_group_select ==1);

% SB_Group{2} = []

MB_Group{2} = [selected_group_ab{2,1}; selected_group_ab{2,2}];


% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================


for ti = 1:1
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = signrank(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))
end

% =======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = em_mb_rt_color(1,:);

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = em_mb_rt_color(2,:); % .2 .2. 2; .3 .4 .5 ];

% significance ==========================================================
for bi = 1:1
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, SBavg(bi)+ 0.15, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(SBavg+ 0.2)])


% labels
acc_Labels = {'Within boundary'; 'Boundary Crossing';};
xticks([1, 2])
xticklabels(acc_Labels)
ylabel('Reaction time decrease (pre-post)')


% title
% legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['RT difference - cross1 & right'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')



%% [WWW & MB] boundary before after - overall rt (1 crossing & right)


selected_group{1,1} = (WWW_Behavior_table.cross1_log_rt_right_trial1_respond(WWW_group_select));
selected_group{1,2} = (WWW_Behavior_table.cross1_log_rt_right_trial2_respond(WWW_group_select));
selected_group{1,3} = (WWW_Behavior_table.cross1_log_rt_right_trial3_respond(WWW_group_select));
selected_group{2,1} = selected_group{1,1};
selected_group{2,2} = selected_group{1,2};
selected_group{2,3} = selected_group{1,2};
selected_group{2,4} = selected_group{1,3};

ind_remove = isnan(selected_group{2,1}) | isnan(selected_group{2,2});
selected_group{2,1}(ind_remove) = [];
selected_group{2,2}(ind_remove) = [];
ind_remove = isnan(selected_group{2,3}) | isnan(selected_group{2,4});
selected_group{2,3}(ind_remove) = [];
selected_group{2,4}(ind_remove) = [];

selected_group{3,1} = selected_group{2,1} - selected_group{2,2};
selected_group{3,2} = selected_group{2,3} - selected_group{2,4};



selected_group_aa{1,1} = (Behavior_table.AAB_log_rt_right_trial1_respond(MB_group_select));
selected_group_aa{1,2} = (Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group_aa{1,3} = (Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));
selected_group_aa{1,4} = (Behavior_table.ABB_log_rt_right_trial3_respond(MB_group_select));

ind_remove = isnan(selected_group_aa{1,1}) | isnan(selected_group_aa{1,2});
selected_group_aa{1,1}(ind_remove) = [];
selected_group_aa{1,2}(ind_remove) = [];
ind_remove = isnan(selected_group_aa{1,3}) | isnan(selected_group_aa{1,4});
selected_group_aa{1,3}(ind_remove) = [];
selected_group_aa{1,4}(ind_remove) = [];

selected_group_aa{2,1} = selected_group_aa{1,1} - selected_group_aa{1,2};
selected_group_aa{2,2} = selected_group_aa{1,3} - selected_group_aa{1,4};


selected_group_ab{1,1} = (Behavior_table.AAB_log_rt_right_trial2_respond(MB_group_select));
selected_group_ab{1,2} = (Behavior_table.AAB_log_rt_right_trial3_respond(MB_group_select));
selected_group_ab{1,3} = (Behavior_table.ABB_log_rt_right_trial1_respond(MB_group_select));
selected_group_ab{1,4} = (Behavior_table.ABB_log_rt_right_trial2_respond(MB_group_select));

ind_remove = isnan(selected_group_ab{1,1}) | isnan(selected_group_ab{1,2});
selected_group_ab{1,1}(ind_remove) = [];
selected_group_ab{1,2}(ind_remove) = [];
ind_remove = isnan(selected_group_ab{1,3}) | isnan(selected_group_ab{1,4});
selected_group_ab{1,3}(ind_remove) = [];
selected_group_ab{1,4}(ind_remove) = [];

selected_group_ab{2,1} = selected_group_ab{1,1} - selected_group_ab{1,2};
selected_group_ab{2,2} = selected_group_ab{1,3} - selected_group_ab{1,4};


a = figure();
a.Position = [1053 623 461 359];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group

WWW_Group = [selected_group{3,1}; selected_group{3,2}];
VB_Group = [selected_group_aa{2,1}; selected_group_aa{2,2}];
MB_Group = [selected_group_ab{2,1}; selected_group_ab{2,2}];

Three_Group = [{WWW_Group}, {VB_Group}, {MB_Group}];

[avg, err] = jh_mean_err(Three_Group);


[h1, p1] = ttest2(WWW_Group, VB_Group)
[h2, p2] = ttest2(WWW_Group, MB_Group)
[h3, p3] = ttest2(VB_Group, MB_Group)


fig_bar = jh_bar(avg, err);  hold on;
set(fig_bar, 'FaceColor', 'flat');
fig_bar.CData = em_vb_mb_color;

for pp = 1:3
    if pp ==1 
        ttp = p1;
        xtp = 1.5; xtpg = [1 2];
        ytp = max(avg(pp)+0.3)
    elseif pp ==2
        ttp = p2;
        xtp = 2; xtpg = [1 3];
        ytp = max(avg(pp)+0.35)        
    elseif pp == 3
        ttp = p3;
        xtp = 2.5; xtpg = [2 3];
        ytp = max(avg(pp)+0.3)
    end
% ttp = p;
if ttp < 0.001
    title_groupdif = [ num2str(ttp,3) '***)' ];
    disp = '***';
elseif ttp < 0.01
    title_groupdif = [ num2str(ttp,3) '**)' ];
    disp = '**';
elseif ttp < 0.05
    title_groupdif = [ num2str(ttp,3) '*)' ];
    disp = '*';
elseif ttp < 0.1
    title_groupdif = [ num2str(ttp,3) '+)' ];
    disp = '+';
else
    title_groupdif = num2str(ttp,3);
    disp = '';
end

text(xtp, ytp, disp, 'FontSize', 13,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

if ttp < 0.05
    plot(xtpg, [ytp-0.03 ytp-0.03], 'Color','black')
end


end

ylim([0 max(avg+ 0.2)])


% labels
acc_Labels = {'Non-Boundary'; 'Within Boundary'; 'Boundary Crossing'};

xticklabels(acc_Labels)
ylabel('Reaction time decrease (pre-post)')


% title
% legend({'Non-Boundary', '', 'Boundary'}, 'EdgeColor', 'none', 'Location', 'Northeast');
% title(['Accuracy'],'FontWeight','bold')


title(['RT difference - cross1 & right'],'FontWeight','bold')
set(gca,'FontName','Arial','FontSize',13,'fontweight','bold','linewidth',2, 'box','off')





%% [WWW & MB] trial 1 2 3 - monster rt







plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_log_rt_right_trial1_animal(MB_group_select));nanmean(Behavior_table.AAB_log_rt_right_trial2_animal(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_right_trial3_animal(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.ABB_log_rt_right_trial1_animal(MB_group_select));nanmean(Behavior_table.ABB_log_rt_right_trial2_animal(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_right_trial3_animal(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_animal(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_animal(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_animal(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(3, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));


xlim([0.7 3.3])
ylim([1 2.6])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Northeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('ln(RT)')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['What RT'],'FontWeight','bold')



%% [WWW & MB] trial 1 2 3 - location rt







plot_trial_range = 1:3;
selected_data1 = [nanmean(Behavior_table.AAB_log_rt_right_trial1_location(MB_group_select));nanmean(Behavior_table.AAB_log_rt_right_trial2_location(MB_group_select)); nanmean(Behavior_table.AAB_log_rt_right_trial3_location(MB_group_select));];
selected_data2 = [nanmean(Behavior_table.ABB_log_rt_right_trial1_location(MB_group_select));nanmean(Behavior_table.ABB_log_rt_right_trial2_location(MB_group_select)); nanmean(Behavior_table.ABB_log_rt_right_trial3_location(MB_group_select));];
selected_data3 = [nanmean(WWW_Behavior_table.cross1_log_rt_right_trial1_location(WWW_group_select));nanmean(WWW_Behavior_table.cross1_log_rt_right_trial2_location(WWW_group_select)); nanmean(WWW_Behavior_table.cross1_log_rt_right_trial3_location(WWW_group_select));];

a = figure();

line1 = plot(plot_trial_range, selected_data1, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(3, :));
hold on
line2 = plot(plot_trial_range, selected_data2, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(2, :));
hold on
line3 = plot(plot_trial_range, selected_data3, '-o', 'LineWidth', 2, 'Color', em_vb_mb_color(1, :));


xlim([0.7 3.3])
ylim([1 2.6])



legend_h = legend({'AAB', 'ABB', 'WWW'}, 'EdgeColor', 'none', 'Location', 'Northeast')
xticks(plot_trial_range)
% yticks([.5 .6 .7 .8 .9 1])
ylabel('ln(RT)')
set(gca,'FontName','Arial','FontSize',14,'fontweight','bold','linewidth',2, 'box','off')
hold off

title(['Where RT'],'FontWeight','bold')






%% [ Boundary user & Non user ] =========================================

MB_group_orig = MB_group_select;

MB_bnd_user_group = (MB_group_orig & Behavior_table.inter_bnd_user) * 2 + (MB_group_orig & ~Behavior_table.inter_bnd_user);
% boundary user 2 non-user 1 / 
WWW_group_orig = WWW_group_select;

WWW_bnd_user_group = (WWW_group_orig & WWW_Behavior_table.inter_bnd_user) * 2 + (WWW_group_orig & ~WWW_Behavior_table.inter_bnd_user);


%% Demographical Difference


% Behavior_table.inter_bnd_user : 1 - user / 0 - non-user
% histo_group = Behavior_table.inter_bnd_user;
histo_group = MB_bnd_user_group;


% www_histo_group = www_age_group;


a = figure();
a.Position = [2650 925 354 253];
subplot(1,2,1);
% histogram(participant_info.age_yr((strcmp(participant_info.sex, '남') & (histo_group == 1)) == 1,:));hold on;
% histogram(participant_info.age_yr((strcmp(participant_info.sex, '여') & (histo_group == 1)) == 1,:)); 
histogram(participant_info.age_yr(histo_group == 2), 'FaceColor','none');
xlim([4.5 9.5]);
ylim([0 13]);
title(['Boundary User' newline '(n = ' num2str(sum(histo_group == 2)) ')' ] , 'FontSize',13, 'FontWeight','bold');
subplot(1,2,2);
histogram(participant_info.age_yr(histo_group == 1), 'FaceColor','none');
xlim([4.5 9.5]);
ylim([0 13]);
title(['Boundary Non-User' newline '(n = ' num2str(sum(histo_group == 1)) ')' ] , 'FontSize',13, 'FontWeight','bold');
sgtitle(['[Multi boundary]'], 'FontSize',13, 'FontWeight','bold')

% histo_group = WWW_Behavior_table.inter_bnd_user;
histo_group = WWW_bnd_user_group
% www_histo_group = www_age_group;


a = figure();
a.Position = [2650 925 354 253];
subplot(1,2,1);
% histogram(participant_info.age_yr((strcmp(participant_info.sex, '남') & (histo_group == 1)) == 1,:));hold on;
% histogram(participant_info.age_yr((strcmp(participant_info.sex, '여') & (histo_group == 1)) == 1,:)); 
histogram(www_participant_info.age_yr(histo_group == 2), 'FaceColor','none');
xlim([4.5 9.5]);
ylim([0 18]);
title(['Boundary User' newline '(n = ' num2str(sum(histo_group == 2)) ')' ] , 'FontSize',13, 'FontWeight','bold');
subplot(1,2,2);
histogram(www_participant_info.age_yr(histo_group == 1), 'FaceColor','none');
xlim([4.5 9.5]);
ylim([0 18]);
title(['Boundary Non-User' newline '(n = ' num2str(sum(histo_group == 1)) ')' ] , 'FontSize',13, 'FontWeight','bold');
sgtitle(['[WCDI]'], 'FontSize',13, 'FontWeight','bold')



%% [MB] group acc difference

% all trial ver) accuracy group difference


% for gi = 1:2

a = figure();
a.Position = [2730 886 560 420];
clearvars WWW_Group MB_Group WWWavg WWWerr MBavg MBerr h p Two_Group SB_Group MB_Group

gi = 1
SB_Group{1} = Behavior_table.acc_what(MB_bnd_user_group==gi);
SB_Group{3} = Behavior_table.acc_whatwhen(MB_bnd_user_group ==gi);
SB_Group{5} = Behavior_table.acc_where(MB_bnd_user_group ==gi);
SB_Group{7} = Behavior_table.acc_wherewhen(MB_bnd_user_group ==gi);
SB_Group{9} = Behavior_table.acc_whatwhere(MB_bnd_user_group ==gi);
SB_Group{11} = Behavior_table.acc_fullem(MB_bnd_user_group ==gi);
% SB_Group{2} = []

gi = 2
MB_Group{2} = Behavior_table.acc_what(MB_bnd_user_group ==gi);
MB_Group{4} = Behavior_table.acc_whatwhen(MB_bnd_user_group ==gi);
MB_Group{6} = Behavior_table.acc_where(MB_bnd_user_group ==gi);
MB_Group{8} = Behavior_table.acc_wherewhen(MB_bnd_user_group ==gi);
MB_Group{10} = Behavior_table.acc_whatwhere(MB_bnd_user_group ==gi);
MB_Group{12} = Behavior_table.acc_fullem(MB_bnd_user_group ==gi);




% avg & err
[SBavg, SBerr] = jh_mean_err(SB_Group);
[MBavg, MBerr] = jh_mean_err(MB_Group);


% stat ==================================================================

% anova
SB_Group_data = cell2mat(SB_Group');
sb_array = cell2mat(arrayfun(@(x) repmat(x, size(SB_Group{x})), [1 3 5 7 9 11], 'uni', 0)');
[~,tbl,sb_stats] = anova1(SB_Group_data,sb_array,'off');
sb_group_compare = multcompare(sb_stats,"Display","off")


MB_Group_data = cell2mat(MB_Group');
mb_array = cell2mat(arrayfun(@(x) repmat(x, size(MB_Group{x})), [2 4 6 8 10 12], 'uni', 0)');
[~,tbl,mb_stats] = anova1(MB_Group_data,mb_array,'off');
mb_group_compare = multcompare(mb_stats,"Display","off")


for ti = 1:6
    % ttest
    [h(ti), p(ti)] = ttest2(SB_Group{(ti-1)*2+1}, MB_Group{ti*2})
    % ranksum
%     [p(ti), h(ti)] = ranksum(round(SB_Group{(ti-1)*2+1},3), round(MB_Group{ti*2},3))

end

% ======================================================================

% draw bar


sb_fig_bar = jh_bar(SBavg, SBerr);  hold on;
sb_fig_bar.FaceColor = [.6 .7 .9];

mb_fig_bar = jh_bar(MBavg, MBerr); hold on;
mb_fig_bar.FaceColor = [.4 .5 .7]; % .2 .2. 2; .3 .4 .5 ];

% if gi == 1
%     sb_fig_bar.FaceColor = [.4 .5 .7];
%     mb_fig_bar.FaceColor = [.5 .3 .7];
% end


% significance ==========================================================
for bi = 1:6
    ttp = p(bi);
    if ttp < 0.001
        title_groupdif = [ num2str(ttp,3) '***)' ];
        disp = '***';
    elseif ttp < 0.01
        title_groupdif = [ num2str(ttp,3) '**)' ];
        disp = '**';
    elseif ttp < 0.05
        title_groupdif = [ num2str(ttp,3) '*)' ];
        disp = '*';
    elseif ttp < 0.1
        title_groupdif = [ num2str(ttp,3) '+)' ];
        disp = '+';
    else
        title_groupdif = num2str(ttp,3);
        disp = '';
    end
    text((bi-1)*2+1.5, MBavg(bi*2)+ 0.2, disp, 'FontSize', 10,'fontweight','bold', 'HorizontalAlignment', 'center', 'Color', 'black');

end

% =======================================================================

ylim([0 max(MBavg+ 0.2)])


% labels
acc_Labels = {'What'; ''; 'What+When'; ''; 'Where'; '';  'Where+When'; ''; 'What+Where'; '';  'FullEM' };
xticklabels(acc_Labels)
ylabel('Accuracy')

% title
legend({'Boundary Non-User', '', 'Boundary User'});

% if gi = 1
%     title(['Accuracy'],'FontWeight','bold')
% else
%     title(['Accuracy'],'FontWeight','bold')



% end




%% [mb] cat2 - cat 1 & other behavior - corr

signum = 0;
figure();
inter_sig_list = zeros(length(Behavior_table.Properties.VariableNames),1);
for ffi = 6:length( Behavior_table.Properties.VariableNames)
    if contains(Behavior_table.Properties.VariableNames{ffi}, 'inter')% ~contains(Behavior_table.Properties.VariableNames{ffi}, 'rt') && ~contains(Behavior_table.Properties.VariableNames{ffi}, 'inter') && contains(Behavior_table.Properties.VariableNames{ffi}, ['select'])
%     if ~ismember(ffi, [10])
    xData = Behavior_table.age_detail(MB_group_select);
    yData = Behavior_table.(Behavior_table.Properties.VariableNames{ffi})(MB_group_select);

    if islogical(yData)
        yData = double(yData);
    end
    xData = reshape(xData,[],1);
    yData = reshape(yData,[],1);
    ind_remove = isnan(xData) | isnan(yData);
    xData(ind_remove) = [];
    yData(ind_remove) = [];
    
    if ~isempty(xData)
        [r,p] = corr(reshape(xData,[],1),reshape(yData,[],1));
   
    
    if p<0.05
        Behavior_table.Properties.VariableNames{ffi}
        inter_sig_list(ffi,1) = 1;
%         figure();
        signum = signum + 1;
        subplot(4,7,signum)
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ Behavior_table.Properties.VariableNames{ffi} newline 'r = ' num2str(r) ' p = ' num2str(p)], 'FontSize',10);
        set(t,'Interpreter','none');
        

    elseif p<0.1
        inter_sig_list(ffi,1) = 2;
        signum = signum + 1;
        subplot(4,7,signum)

%         figure();
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ Behavior_table.Properties.VariableNames{ffi} newline 'r = ' num2str(r) ' p = ' num2str(p)], 'FontSize',10);
        set(t,'Interpreter','none');

    end

    end
    end

end
sgtitle(['Intertrial Category 2 ACC - Category 1 ACC'])


%% [www] cat2 - cat 1 & other behavior - corr

signum = 0;
figure();
inter_sig_list = zeros(length(WWW_Behavior_table.Properties.VariableNames),1);
for ffi = 6:length( WWW_Behavior_table.Properties.VariableNames)
    if ~contains(WWW_Behavior_table.Properties.VariableNames{ffi}, 'inter') %&& ~contains(WWW_Behavior_table.Properties.VariableNames{ffi}, 'rt') %&& contains(WWW_Behavior_table.Properties.VariableNames{ffi}, ['cross1'])
%     if ~ismember(ffi, [10])
    xData = WWW_Behavior_table.inter_bnd_use_index(WWW_group_select);
    yData = WWW_Behavior_table.(WWW_Behavior_table.Properties.VariableNames{ffi})(WWW_group_select);

    if islogical(yData)
        yData = double(yData);
    end
    xData = reshape(xData,[],1);
    yData = reshape(yData,[],1);
    ind_remove = isnan(xData) | isnan(yData);
    xData(ind_remove) = [];
    yData(ind_remove) = [];
    
    if ~isempty(xData)
        [r,p] = corr(reshape(xData,[],1),reshape(yData,[],1));
   
    
    if p<0.05
        Behavior_table.Properties.VariableNames{ffi}
        inter_sig_list(ffi,1) = 1;
%         figure();
        signum = signum + 1;
        subplot(1,4,signum)
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ WWW_Behavior_table.Properties.VariableNames{ffi} newline 'r = ' num2str(r) ' p = ' num2str(p)], 'FontSize',10);
        set(t,'Interpreter','none');
        

    elseif p<0.1
        inter_sig_list(ffi,1) = 2;
        signum = signum + 1;
        subplot(1,4,signum)

%         figure();
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ WWW_Behavior_table.Properties.VariableNames{ffi} newline 'r = ' num2str(r) ' p = ' num2str(p)], 'FontSize',10);
        set(t,'Interpreter','none');

    end

    end
    end

end
sgtitle(['Intertrial Category 2 ACC - Category 1 ACC'])

%% [mb] correlation 
condition ={'age_detail'};
condition2 ={'select_within_acc'};


plot_age_range = 6:8;
age_group = participant_info.age_yr>=plot_age_range(1) &  participant_info.age_yr<= plot_age_range(end);
MB_group_select = age_group & ~MB_reject.sub_reject;


a = figure();
a.Position = [1000 1015 284 323];
    xData = Behavior_table.(condition{1})(MB_group_select);
    yData = Behavior_table.(condition2{1})(MB_group_select);
    if islogical(yData)
        yData = double(yData);
    end
    xData = reshape(xData,[],1);
    yData = reshape(yData,[],1);
    ind_remove = isnan(xData) | isnan(yData);
    xData(ind_remove) = [];
    yData(ind_remove) = [];

%     [r,p] = corr(reshape(xData,[],1),reshape(yData,[],1));
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ condition{1} '&' condition2{1} newline 'r = ' num2str(r) ' p = ' num2str(p) newline ]);
        set(t,'Interpreter','none');

%% [www] correlation 
condition ={'age_detail'};
condition2 ={'cross1_within_acc'};


% plot_age_range = 6:8;
age_group = www_participant_info.age_yr>=plot_age_range(1) &  www_participant_info.age_yr<= plot_age_range(end);
WWW_group_select = age_group & ~www_reject.sub_reject;

 
a = figure();
a.Position = [1000 1015 284 323];
    xData = WWW_Behavior_table.(condition{1})(WWW_group_select);
    yData = WWW_Behavior_table.(condition2{1})(WWW_group_select);
    if islogical(yData)
        yData = double(yData);
    end
    xData = reshape(xData,[],1);
    yData = reshape(yData,[],1);
    ind_remove = isnan(xData) | isnan(yData);
    xData(ind_remove) = [];
    yData(ind_remove) = [];

%     [r,p] = corr(reshape(xData,[],1),reshape(yData,[],1));
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ condition{1} '&' condition2{1} newline 'r = ' num2str(r) ' p = ' num2str(p) newline ]);
        set(t,'Interpreter','none');


%% [www & MB] correlation 
condition_WWW ={'age_detail'};
condition_MB ={'age_detail'};

condition2_WWW ={'inter_bnd_use_index'};
condition2_MB ={'inter_bnd_use_index'};


% plot_age_range = 6:8;
www_age_group = www_participant_info.age_yr>=plot_age_range(1) &  www_participant_info.age_yr<= plot_age_range(end);
WWW_group_select = www_age_group & ~www_reject.sub_reject;
age_group = participant_info.age_yr>=plot_age_range(1) &  participant_info.age_yr<= plot_age_range(end);
MB_group_select = age_group & ~MB_reject.sub_reject;




 
a = figure();
a.Position = [1000 1015 284 323];
    xData = [WWW_Behavior_table.(condition_WWW{1})(WWW_group_select); Behavior_table.(condition_MB{1})(MB_group_select)];
    yData = [WWW_Behavior_table.(condition2_WWW{1})(WWW_group_select); Behavior_table.(condition2_MB{1})(MB_group_select)];
    if islogical(yData)
        yData = double(yData);
    end
    xData = reshape(xData,[],1);
    yData = reshape(yData,[],1);
    ind_remove = isnan(xData) | isnan(yData);
    xData(ind_remove) = [];
    yData(ind_remove) = [];

%     [r,p] = corr(reshape(xData,[],1),reshape(yData,[],1));
        [r, p] = func_corr(xData, yData, task_Color.default, 'on');
        t = title([ condition_WWW{1} '&' condition2_WWW{1} newline 'r = ' num2str(r) ' p = ' num2str(p) newline ]);
        set(t,'Interpreter','none');


%%